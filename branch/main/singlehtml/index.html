

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python Progression: Moving Beyond the Basics documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />
      <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
      <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_lesson.css" />
      <link rel="stylesheet" type="text/css" href="_static/term_role_formatting.css" />
      <link rel="stylesheet" type="text/css" href="_static/sphinx_rtd_theme_ext_color_contrast.css" />
      <link rel="stylesheet" type="text/css" href="_static/style.css" />
      <link rel="stylesheet" type="text/css" href="_static/tabs.css" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js"></script>
      <script src="_static/doctools.js"></script>
      <script src="_static/sphinx_highlight.js"></script>
      <script src="_static/clipboard.min.js"></script>
      <script src="_static/copybutton.js"></script>
      <script src="_static/minipres.js"></script>
      <script>let toggleHintShow = 'Click to show';</script>
      <script>let toggleHintHide = 'Click to hide';</script>
      <script>let toggleOpenOnPrint = 'true';</script>
      <script src="_static/togglebutton.js"></script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <script src="_static/tabs.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            Python Progression: Moving Beyond the Basics
          </a>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Episodes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#document-installation">Software install instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-python-basics">Python basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-jupyter">Jupyter Notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-tidy-data">Data formats, tidy data, and data cleaning</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-plotting">Plotting with Vega-Altair</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-gallery">Learning how to adapt existing gallery examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-notebooks_to_scripts">From notebooks to scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-CLI">Command-line interfaces (CLI)</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-good-practices">Good practices and tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-version-control">Version control (motivation)</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-dependencies">Reproducible environments and dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-documentation">Where to start with documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-profiling">Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="#document-testing">Automated testing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="#document-credit">Credit</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.github.io/python-progression/lesson.pdf">PDF version</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/">All lessons</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/">CodeRefinery</a></li>
<li class="toctree-l1"><a class="reference external" href="https://coderefinery.org/lessons/reusing/">Reusing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Python Progression: Moving Beyond the Basics</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Python Progression: Moving Beyond the Basics  documentation</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/coderefinery/python-progression/blob/main/content/index" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="python-progression-moving-beyond-the-basics">
<h1>Python Progression: Moving Beyond the Basics<a class="headerlink" href="#python-progression-moving-beyond-the-basics" title="Link to this heading"></a></h1>
<p>In this short intermediate-level workshop, we will learn how to write Python
with a focus on reproducibility and re-usability.</p>
<p>We will start in <a class="reference external" href="https://jupyter.org/">Jupyter Notebooks</a> and later move to
running Python scripts from the command line.</p>
<section id="who-is-the-course-for">
<h2>Who is the course for?<a class="headerlink" href="#who-is-the-course-for" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>Somebody who has written Python scripts or notebooks and wants to improve their code style and code re-usability.</p></li>
<li><p>Somebody who needs to read, process, and plot data for their work or studies.</p></li>
<li><p>Persons who already use Python for this but want to learn about libraries
to simplify common tasks and about how to share their workflow in a reproducible way.</p></li>
</ul>
<div class="admonition-preparation prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Preparation</p>
<ul class="simple">
<li><p>We assume everybody follows on their computer with network access</p></li>
<li><p><a class="reference internal" href="#document-installation"><span class="doc">Software install instructions</span></a> (but we will go through this together)</p></li>
</ul>
</div>
</section>
<section id="episode-overview">
<h2>Episode overview<a class="headerlink" href="#episode-overview" title="Link to this heading"></a></h2>
<p><strong>Warm-up</strong>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#document-python-basics"><span class="doc">Python basics</span></a></p></li>
</ul>
<p><strong>Day 1 morning</strong>:</p>
<ul class="simple">
<li><p>11:00 - 12:30</p>
<ul>
<li><p><a class="reference internal" href="#document-installation"><span class="doc">Software install instructions</span></a></p></li>
<li><p><a class="reference internal" href="#document-jupyter"><span class="doc">Jupyter Notebooks</span></a></p></li>
<li><p><a class="reference internal" href="#document-tidy-data"><span class="doc">Data formats, tidy data, and data cleaning</span></a></p></li>
</ul>
</li>
</ul>
<p><strong>Day 1 afternoon</strong>:</p>
<ul class="simple">
<li><p>13:30 - 15:00</p>
<ul>
<li><p><a class="reference internal" href="#document-plotting"><span class="doc">Plotting with Vega-Altair</span></a></p></li>
<li><p><a class="reference internal" href="#document-gallery"><span class="doc">Learning how to adapt existing gallery examples</span></a></p></li>
</ul>
</li>
<li><p>15:30 - 17:00</p>
<ul>
<li><p><a class="reference internal" href="#document-notebooks_to_scripts"><span class="doc">From notebooks to scripts</span></a></p></li>
<li><p><a class="reference internal" href="#document-CLI"><span class="doc">Command-line interfaces (CLI)</span></a></p></li>
<li><p><a class="reference internal" href="#document-good-practices"><span class="doc">Good practices and tools</span></a></p></li>
</ul>
</li>
<li><p>17:00 - 18:00</p>
<ul>
<li><p>Q&amp;A</p></li>
<li><p>Working on own scripts/projects</p></li>
</ul>
</li>
</ul>
<p><strong>Day 2 morning</strong>:</p>
<ul class="simple">
<li><p>09:00 - 09:45</p>
<ul>
<li><p><a class="reference internal" href="#document-version-control"><span class="doc">Version control (motivation)</span></a></p></li>
<li><p><a class="reference internal" href="#document-dependencies"><span class="doc">Reproducible environments and dependencies</span></a></p></li>
<li><p><a class="reference internal" href="#document-documentation"><span class="doc">Where to start with documentation</span></a></p></li>
</ul>
</li>
<li><p>09:45 - 10:20</p>
<ul>
<li><p><a class="reference internal" href="#document-profiling"><span class="doc">Profiling</span></a></p></li>
</ul>
</li>
<li><p>10:30 - 11:00</p>
<ul>
<li><p><a class="reference internal" href="#document-testing"><span class="doc">Automated testing</span></a></p></li>
</ul>
</li>
</ul>
<div class="toctree-wrapper compound">
<span id="document-installation"></span><section id="software-install-instructions">
<span id="installation"></span><h3>Software install instructions<a class="headerlink" href="#software-install-instructions" title="Link to this heading"></a></h3>
<p>[this page is adapted from <a class="reference external" href="https://aaltoscicomp.github.io/python-for-scicomp/installation/">https://aaltoscicomp.github.io/python-for-scicomp/installation/</a>]</p>
<section id="choosing-an-installation-method">
<h4>Choosing an installation method<a class="headerlink" href="#choosing-an-installation-method" title="Link to this heading"></a></h4>
<p>For this course we will install an <strong>isolated environment</strong>
with following dependencies:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">environment.yml</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">requirements.txt</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">course</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python &lt;= 3.12</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jupyterlab</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">altair-all</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vega_datasets</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">numpy</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytest</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scalene</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ruff</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">icecream</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myst-parser</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx-rtd-theme</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx-autoapi</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx-autobuild</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupyterlab</span>
<span class="n">altair</span>
<span class="n">vega_datasets</span>
<span class="n">pandas</span>
<span class="n">numpy</span>
<span class="n">pytest</span>
<span class="n">scalene</span>
<span class="n">ruff</span>
<span class="n">icecream</span>
<span class="n">myst</span><span class="o">-</span><span class="n">parser</span>
<span class="n">sphinx</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">rtd</span><span class="o">-</span><span class="n">theme</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">autoapi</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">autobuild</span>
</pre></div>
</div>
</div></div>
<p>If you are used to installing packages in Python and know what to do with the
above files, please follow your own preferred installation
method.</p>
<p><strong>If you are new to Python or unsure</strong> how to create isolated environments in
Python from files above, please follow the
instructions below.</p>
<div class="admonition-there-are-many-choices-and-we-try-to-suggest-a-good-compromise discussion important admonition" id="discussion-0">
<p class="admonition-title">There are many choices and we try to suggest a good compromise</p>
<p>There are very many ways to install Python and packages with pros and cons and
in addition there are several operating systems with their own quirks. This
can be a huge challenge for beginners to navigate. It can also difficult for
instructors to give recommendations for something which will work everywhere
and which everybody will like.</p>
<p>Below we will recommend <strong>Miniforge</strong> since it is free, open source, general,
available on all operating systems, and provides a good basis for reproducible
environments. However, it does not provide a graphical user interface during
installation. This means that every time we want to start a JupyterLab session,
we will have to go through the command line.</p>
</div>
<div class="dropdown admonition">
<p class="admonition-title">Python, conda, anaconda, miniforge, etc?</p>
<p>Unfortunately there are many options and a lot of jargon.
Here is a crash course:</p>
<ul class="simple">
<li><p><strong>Python</strong> is a programming language very commonly used in
science, it’s the topic of this course.</p></li>
<li><p><strong>Conda</strong> is a package manager: it allows distributing and
installing packages, and is designed for complex scientific
code.</p></li>
<li><p><strong>Mamba</strong> is a re-implementation of Conda to be much faster with
resolving dependencies and installing things.</p></li>
<li><p>An <strong>environment</strong> is a self-contained collections of packages
which can be installed separately from others.  They are used so
each project can install what it needs without affecting others.</p></li>
<li><p><strong>Anaconda</strong> is a commercial distribution of Python+Conda+many
packages that all work together.  It used to be freely usable for
research, but since ~2023-2024 it’s more limited.  Thus, we don’t
recommend it (even though it has a nice graphical user interface).</p></li>
<li><p><strong>conda-forge</strong> is another channel of distributing packages that
is maintained by the community, and thus can be used by anyone.
(Anaconda’s parent company also hosts conda-forge packages)</p></li>
<li><p><strong>Miniforge</strong> is a distribution of conda pre-configured for
conda-forge.  It operates via the command line.</p></li>
<li><p><strong>Miniconda</strong> is a distribution of conda pre-configured to use
the Anaconda channels.</p></li>
</ul>
<p>We will gain a better background and overview in the section
<a class="reference internal" href="#document-dependencies"><span class="doc">Reproducible environments and dependencies</span></a>.</p>
</div>
</section>
<section id="installing-python-via-miniforge">
<h4>Installing Python via Miniforge<a class="headerlink" href="#installing-python-via-miniforge" title="Link to this heading"></a></h4>
<p>Follow the <a class="reference external" href="https://github.com/conda-forge/miniforge">instructions on the miniforge web page</a>.  This installs
the base, and from here other packages can be installed.</p>
<p>Unsure what to download and what to do with it?</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-V2luZG93cw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="0">Windows</button><button aria-controls="panel-1-TWFjT1M=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-TWFjT1M=" name="TWFjT1M=" role="tab" tabindex="-1">MacOS</button><button aria-controls="panel-1-TGludXg=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-TGludXg=" name="TGludXg=" role="tab" tabindex="-1">Linux</button></div><div aria-labelledby="tab-1-V2luZG93cw==" class="sphinx-tabs-panel group-tab" id="panel-1-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><p>You want to download and run <code class="docutils literal notranslate"><span class="pre">Miniforge3-Windows-x86_64.exe</span></code>.</p>
</div><div aria-labelledby="tab-1-TWFjT1M=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-TWFjT1M=" name="TWFjT1M=" role="tabpanel" tabindex="0"><p>You probably want to download the <code class="docutils literal notranslate"><span class="pre">Miniforge3-MacOSX-arm64.sh</span></code> file (unless
you don’t have an Arm processor) and then run it in the terminal with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>bash<span class="w"> </span>Miniforge3-MacOSX-arm64.sh
</pre></div>
</div>
</div><div aria-labelledby="tab-1-TGludXg=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-TGludXg=" name="TGludXg=" role="tabpanel" tabindex="0"><p>You probably want to download the <code class="docutils literal notranslate"><span class="pre">Miniforge3-Linux-x86_64.sh</span></code> file (unless
you don’t have an x86_64 processor) and then run it in the terminal with:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>bash<span class="w"> </span>Miniforge3-Linux-x86_64.sh
</pre></div>
</div>
</div></div>
</section>
<section id="installing-and-activating-the-software-environment">
<h4>Installing and activating the software environment<a class="headerlink" href="#installing-and-activating-the-software-environment" title="Link to this heading"></a></h4>
<p>First we will start Python in a way that activates conda/mamba.  Then we will
install the software environment from <a class="reference external" href="https://raw.githubusercontent.com/coderefinery/python-progression/main/software/environment.yml">this environment.yml
file</a>.</p>
<p>An <strong>environment</strong> is a self-contained set of extra libraries - different
projects can use different environments to not interfere with each other.  This
environment will have all of the software needed for this particular course.</p>
<p>We will call the environment <code class="docutils literal notranslate"><span class="pre">course</span></code>.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-V2luZG93cw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="0">Windows</button><button aria-controls="panel-2-TGludXggLyBNYWNPUw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tab" tabindex="-1">Linux / MacOS</button></div><div aria-labelledby="tab-2-V2luZG93cw==" class="sphinx-tabs-panel group-tab" id="panel-2-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><p>Use the “Miniforge Prompt” to start Miniforge.  This
will set up everything so that <code class="docutils literal notranslate"><span class="pre">conda</span></code> and <code class="docutils literal notranslate"><span class="pre">mamba</span></code> are
available.
Then type
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mamba<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>course<span class="w"> </span>-f<span class="w"> </span>https://raw.githubusercontent.com/coderefinery/python-progression/main/software/environment.yml
</pre></div>
</div>
</div><div aria-labelledby="tab-2-TGludXggLyBNYWNPUw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tabpanel" tabindex="0"><p>Each time you start a new command line terminal,
you can activate Miniforge by running
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">source</span><span class="w"> </span>~/miniforge3/bin/activate
</pre></div>
</div>
<p>This is needed so that
Miniforge is usable wherever you need, but doesn’t affect any
other software on your computer (this is not needed if you
choose “Do you wish to update your shell profile to
automatically initialize conda?”, but then it will always be
active).</p>
<p>In the second step, we will install the software environment:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mamba<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>course<span class="w"> </span>-f<span class="w"> </span>https://raw.githubusercontent.com/coderefinery/python-progression/main/software/environment.yml
</pre></div>
</div>
</div></div>
</section>
<section id="starting-jupyterlab">
<h4>Starting JupyterLab<a class="headerlink" href="#starting-jupyterlab" title="Link to this heading"></a></h4>
<p>Every time we want to start a JupyterLab session,
we will have to go through the command line and first
activate the <code class="docutils literal notranslate"><span class="pre">course</span></code> environment.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-V2luZG93cw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-3-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="0">Windows</button><button aria-controls="panel-3-TGludXggLyBNYWNPUw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-3-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tab" tabindex="-1">Linux / MacOS</button></div><div aria-labelledby="tab-3-V2luZG93cw==" class="sphinx-tabs-panel group-tab" id="panel-3-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><p>Start the Miniforge Prompt. Then type
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda<span class="w"> </span>activate<span class="w"> </span>course
<span class="gp">$ </span>jupyter-lab
</pre></div>
</div>
</div><div aria-labelledby="tab-3-TGludXggLyBNYWNPUw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-3-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tabpanel" tabindex="0"><p>Start the terminal and in the terminal, type
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">source</span><span class="w"> </span>~/miniforge3/bin/activate
<span class="gp">$ </span>conda<span class="w"> </span>activate<span class="w"> </span>course
<span class="gp">$ </span>jupyter-lab
</pre></div>
</div>
</div></div>
</section>
<section id="removing-the-software-environment">
<h4>Removing the software environment<a class="headerlink" href="#removing-the-software-environment" title="Link to this heading"></a></h4>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-V2luZG93cw==" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-4-V2luZG93cw==" name="V2luZG93cw==" role="tab" tabindex="0">Windows</button><button aria-controls="panel-4-TGludXggLyBNYWNPUw==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-4-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tab" tabindex="-1">Linux / MacOS</button></div><div aria-labelledby="tab-4-V2luZG93cw==" class="sphinx-tabs-panel group-tab" id="panel-4-V2luZG93cw==" name="V2luZG93cw==" role="tabpanel" tabindex="0"><p>In the Miniforge Prompt, type
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>list
<span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>remove<span class="w"> </span>--name<span class="w"> </span>course
<span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>list
</pre></div>
</div>
</div><div aria-labelledby="tab-4-TGludXggLyBNYWNPUw==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-4-TGludXggLyBNYWNPUw==" name="TGludXggLyBNYWNPUw==" role="tabpanel" tabindex="0"><p>In the terminal, type
(without the <code class="docutils literal notranslate"><span class="pre">$</span></code>):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">source</span><span class="w"> </span>~/miniforge3/bin/activate
<span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>list
<span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>remove<span class="w"> </span>--name<span class="w"> </span>course
<span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>list
</pre></div>
</div>
</div></div>
</section>
<section id="how-to-verify-your-installation">
<h4>How to verify your installation<a class="headerlink" href="#how-to-verify-your-installation" title="Link to this heading"></a></h4>
<p><strong>Start JupyterLab</strong> (as described above).  It will hopefully open up your browser
and look like this:</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/testing-jupyter1.png"><img alt="JupyterLab opened in the browser" src="_images/testing-jupyter1.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">JupyterLab opened in the browser. Click on the Python 3 tile.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Once you clicked the Python 3 tile it should look like this:</p>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/testing-jupyter2.png"><img alt="Python 3 notebook started" src="_images/testing-jupyter2.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Python 3 notebook started.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Into that blue “cell” please type the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">altair</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;all good - ready for the course&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="_images/testing-jupyter3.png"><img alt="Screenshot where we test to import required libraries." src="_images/testing-jupyter3.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Please copy these lines and click on the “play”/”run” icon.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This is how it should look:</p>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="_images/testing-jupyter4.png"><img alt="Screenshot after successful import." src="_images/testing-jupyter4.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Screenshot after successful import.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>If this worked, you are all set and can close JupyterLab (no need to save these
changes).</p>
<p>This is how it <strong>should not</strong> look:</p>
<figure class="align-default" id="id5">
<a class="reference internal image-reference" href="_images/testing-jupyter5.png"><img alt="Required packages could not be found." src="_images/testing-jupyter5.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Error: required packages could not be found.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
</section>
<span id="document-python-basics"></span><section id="python-basics">
<h3>Python basics<a class="headerlink" href="#python-basics" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Knowing what types exist</p></li>
<li><p>Knowing the most common data structures (collections): lists, tuples, dictionaries, and sets</p></li>
<li><p>Creating and using functions</p></li>
<li><p>Knowing what a library is</p></li>
<li><p>Knowing what <code class="docutils literal notranslate"><span class="pre">import</span></code> does</p></li>
<li><p>Being able to “read” an error</p></li>
</ul>
</div>
<section id="motivation-for-python">
<h4>Motivation for Python<a class="headerlink" href="#motivation-for-python" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Free</strong></p></li>
<li><p>Huge <strong>ecosystem of examples, libraries, and tools</strong></p></li>
<li><p>Relatively easy to read and understand</p></li>
<li><p>Similar in scope and use cases to R, Julia, and Matlab</p></li>
</ul>
</section>
<section id="basic-types">
<h4>Basic types<a class="headerlink" href="#basic-types" title="Link to this heading"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># int</span>
<span class="n">num_measurements</span> <span class="o">=</span> <span class="mi">13</span>

<span class="c1"># float</span>
<span class="n">some_fraction</span> <span class="o">=</span> <span class="mf">0.25</span>

<span class="c1"># string</span>
<span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Bruce Wayne&quot;</span>

<span class="c1"># bool</span>
<span class="n">value_is_missing</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">skip_verification</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># we can print values</span>
<span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># and we can do arithmetics with ints and floats</span>
<span class="nb">print</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">num_measurements</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">-</span> <span class="n">some_fraction</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Python is <strong>dynamically typed</strong>:
We do not have to define that an integer is an <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, we can use it this way
and Python will infer it.</p></li>
<li><p>However, one can use <a class="reference external" href="https://docs.python.org/3/library/typing.html">type annotations</a> in Python
(see also <a class="reference external" href="http://mypy-lang.org/">mypy</a>).</p></li>
<li><p>Now you also know that we can add <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">comments</span></code> to our code.</p></li>
</ul>
</section>
<section id="data-structures-for-collections-lists-dictionaries-sets-and-tuples">
<h4>Data structures for collections: lists, dictionaries, sets, and tuples<a class="headerlink" href="#data-structures-for-collections-lists-dictionaries-sets-and-tuples" title="Link to this heading"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># lists are good when order is important</span>
<span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="c1"># first element</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># we can add items to lists</span>
<span class="n">scores</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># lists can be sorted</span>
<span class="n">scores</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>

<span class="c1"># dictionaries are useful if you want to look up</span>
<span class="c1"># elements in a collection by something else than position</span>
<span class="n">experiment</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;Svalbard&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-03-23&quot;</span><span class="p">,</span> <span class="s2">&quot;num_measurements&quot;</span><span class="p">:</span> <span class="mi">23</span><span class="p">}</span>

<span class="nb">print</span><span class="p">(</span><span class="n">experiment</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span>

<span class="c1"># we can add items to dictionaries</span>
<span class="n">experiment</span><span class="p">[</span><span class="s2">&quot;instrument&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;a particular brand&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">experiment</span><span class="p">)</span>

<span class="k">if</span> <span class="s2">&quot;instrument&quot;</span> <span class="ow">in</span> <span class="n">experiment</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;yes, the dictionary &#39;experiment&#39; contains the key &#39;instrument&#39;&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;no, it doesn&#39;t&quot;</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lists</span></code></a> are good when order is important, and it
needs to be changed</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dictionaries</span></code></a> are mappings key→value.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sets</span></code></a> are useful for unordered collections where you want to make sure that there are no repetitions.</p></li>
<li><p>There are also <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuples</span></code></a> that are similar to lists but their items cannot be modified.</p></li>
</ul>
<p>You can put:</p>
<ul class="simple">
<li><p>dictionaries inside lists</p></li>
<li><p>lists inside dictionaries</p></li>
<li><p>dictionaries inside dictionaries</p></li>
<li><p>lists inside lists</p></li>
<li><p>tuples inside …</p></li>
<li><p>…</p></li>
</ul>
</section>
<section id="iterating-over-collections">
<h4>Iterating over collections<a class="headerlink" href="#iterating-over-collections" title="Link to this heading"></a></h4>
<p>Often we wish to iterate over collections.</p>
<p>Iterating over a list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>

<span class="c1"># example with f-strings</span>
<span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;the score is </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We don’t have to call the variable inside the for-loop “score”. This is up to us.
We can do this instead (but is this more understandable for humans?):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>Iterating over a dictionary:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">experiment</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="s2">&quot;Svalbard&quot;</span><span class="p">,</span> <span class="s2">&quot;date&quot;</span><span class="p">:</span> <span class="s2">&quot;2021-03-23&quot;</span><span class="p">,</span> <span class="s2">&quot;num_measurements&quot;</span><span class="p">:</span> <span class="mi">23</span><span class="p">}</span>

<span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">experiment</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">experiment</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>

<span class="c1"># another way to iterate</span>
<span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="ow">in</span> <span class="n">experiment</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="functions">
<h4>Functions<a class="headerlink" href="#functions" title="Link to this heading"></a></h4>
<ul>
<li><p>Functions are like <strong>reusable recipes</strong>. They receive ingredients (input arguments),
then inside the function we do/compute something with these arguments,
and they return a result.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>
    <span class="k">return</span> <span class="n">result</span>
</pre></div>
</div>
</li>
<li><p>Together we can write a function which sums all elements in a list (this is
not the most elegant way to do this but it is easier at this point):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add_all_elements</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function adds all elements.</span>
<span class="sd">    This here is a docstring, a documentation string for a function.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">element</span>
    <span class="k">return</span> <span class="n">s</span>


<span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">add_all_elements</span><span class="p">(</span><span class="n">measurements</span><span class="p">))</span>
</pre></div>
</div>
</li>
<li><p>We reuse this function to write a function which computes the mean:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="c1"># we are reusing add_all_elements written above</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">add_all_elements</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="n">n</span>


<span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">mean</span> <span class="o">=</span> <span class="n">arithmetic_mean</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Functions can call other functions. Functions can also get other functions as
input arguments.</p></li>
<li><p>Functions can return more than one thing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">uppercase_and_lowercase</span><span class="p">(</span><span class="n">text</span><span class="p">):</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">l</span>


<span class="n">some_text</span> <span class="o">=</span> <span class="s2">&quot;SequenceOfCharacters&quot;</span>
<span class="n">uppercased_text</span><span class="p">,</span> <span class="n">lowercased_text</span> <span class="o">=</span> <span class="n">uppercase_and_lowercase</span><span class="p">(</span><span class="n">some_text</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">uppercased_text</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lowercased_text</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
<p><strong>Why functions?</strong></p>
<ul class="simple">
<li><p>Less repetition</p></li>
<li><p>Simplify reading and understanding code</p></li>
<li><p>Simpler re-use of code</p></li>
<li><p>Make it easier for Python to deallocate memory</p></li>
</ul>
</section>
<section id="reading-error-messages">
<h4>Reading error messages<a class="headerlink" href="#reading-error-messages" title="Link to this heading"></a></h4>
<p>Here we introduce a mistake and we together try to make sense of the traceback:</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/error.png"><img alt="Example error traceback" src="_images/error.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Example error traceback. Can you explain the error?</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="libraries">
<h4>Libraries<a class="headerlink" href="#libraries" title="Link to this heading"></a></h4>
<p>We can look at libraries as collections of functions. We can import the libraries/modules
and then reuse the functions defined inside these libraries.</p>
<p>Try this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span>

<span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">measurements</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<p>This means <code class="docutils literal notranslate"><span class="pre">numpy</span></code> contains a function called <code class="docutils literal notranslate"><span class="pre">std</span></code> which apparently computes the standard deviation
(check also its <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.std.html">documentation</a>).</p>
<p>Often you see this in tutorials (the module is imported and renamed to a shortcut):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
</pre></div>
</div>
<p>It is possible to create own modules to collect own functions for reuse.</p>
</section>
<section id="great-resources-to-learn-more">
<h4>Great resources to learn more<a class="headerlink" href="#great-resources-to-learn-more" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://realpython.com/">Real Python Tutorials</a> (great for beginners)</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/tutorial/index.html">The Python Tutorial</a> (great for beginners)</p></li>
<li><p><a class="reference external" href="https://docs.python-guide.org/">The Hitchhiker’s Guide to Python!</a> (intermediate level)</p></li>
<li><p><a class="reference external" href="https://effectivepython.com/">Effective Python</a> (once you know the basics and want to write better code)</p></li>
</ul>
</section>
<section id="exercises">
<h4>Exercises<a class="headerlink" href="#exercises" title="Link to this heading"></a></h4>
<div class="admonition-exercise-create-a-function-that-computes-the-standard-deviation exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: create a function that computes the standard deviation</p>
<ul>
<li><p>Arithmetic mean:</p>
<div class="math notranslate nohighlight">
\[\bar{x} = \frac{1}{N} \sum_{i=1}^N x_i\]</div>
</li>
<li><p>Standard deviation:</p>
<div class="math notranslate nohighlight">
\[\sqrt{ \frac{1}{N} \sum_{i=1}^N (x_i - \bar{x})^2 }\]</div>
</li>
<li><p>In other words the computation is similar but we need to sum over squares of differences and at the end take a square root.</p></li>
<li><p>Take this as a starting point:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we have written this one together previously</span>
<span class="k">def</span><span class="w"> </span><span class="nf">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">element</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="n">n</span>


<span class="k">def</span><span class="w"> </span><span class="nf">standard_deviation</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="c1"># here we need to do some work:</span>
    <span class="c1"># mean = ?</span>
    <span class="c1"># s = ?</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</pre></div>
</div>
</li>
<li><p>If this is the input list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<p>Then the result would be: 2.872…</p>
</li>
</ul>
</div>
<div class="admonition-solution-1-longer-but-hopefully-easier-to-understand solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution 1 (longer but hopefully easier to understand)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we have written this one together previously</span>
<span class="k">def</span><span class="w"> </span><span class="nf">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">element</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="n">n</span>


<span class="c1"># notice how this function reuses the other</span>
<span class="k">def</span><span class="w"> </span><span class="nf">standard_deviation</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
<span class="hll">    <span class="n">mean</span> <span class="o">=</span> <span class="n">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
</span><span class="hll">    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span class="hll">    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
</span><span class="hll">        <span class="n">s</span> <span class="o">+=</span> <span class="p">(</span><span class="n">element</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</span>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</pre></div>
</div>
</div>
<div class="admonition-solution-2-more-compact solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution 2 (more compact)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">standard_deviation</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
<span class="hll">    <span class="n">mean</span> <span class="o">=</span> <span class="n">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
</span><span class="hll">    <span class="n">s</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">])</span>
</span>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">s</span> <span class="o">/</span> <span class="n">n</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</pre></div>
</div>
</div>
<div class="admonition-exercise-working-with-a-dictionary exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise: working with a dictionary</p>
<ul>
<li><p>We have this dictionary as a starting point:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Alice&quot;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">:</span> <span class="mi">95</span><span class="p">}</span>
</pre></div>
</div>
</li>
<li><p>Add the grades of few more (fictious) persons to this dictionary.</p></li>
<li><p>Print the entire dictionary.</p></li>
<li><p>What happens when you add a name which already exists (with a different grade)?</p></li>
<li><p>Print the grade for one particular person only.</p></li>
<li><p>What happens when you try to print the result for a person that wasn’t there?</p></li>
<li><p>Try also these:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-2">
<p class="admonition-title">Solution</p>
<p>We can add more people like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grades</span><span class="p">[</span><span class="s2">&quot;Craig&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">56</span>
<span class="n">grades</span><span class="p">[</span><span class="s2">&quot;Dave&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">grades</span><span class="p">[</span><span class="s2">&quot;Eve&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">75</span>
</pre></div>
</div>
<p>Print the entire dictionary with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="p">)</span>
</pre></div>
</div>
<p>We get:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;Alice&#39;</span><span class="p">:</span> <span class="mi">80</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">:</span> <span class="mi">95</span><span class="p">,</span> <span class="s1">&#39;Craig&#39;</span><span class="p">:</span> <span class="mi">56</span><span class="p">,</span> <span class="s1">&#39;Dave&#39;</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="s1">&#39;Eve&#39;</span><span class="p">:</span> <span class="mi">75</span><span class="p">}</span>
</pre></div>
</div>
<p>Adding an entry which already exists updates the entry (please try it).</p>
<p>Printing the result for one particular person:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="p">[</span><span class="s2">&quot;Eve&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>Printing the result for a person which does not exists, gives a <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>.</p>
<p>The outputs of these three:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">grades</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
</pre></div>
</div>
<p>… are either the only the keys or only the values, or in the case of <code class="docutils literal notranslate"><span class="pre">items()</span></code>,
key-value pairs (tuples):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dict_keys</span><span class="p">([</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="s1">&#39;Craig&#39;</span><span class="p">,</span> <span class="s1">&#39;Dave&#39;</span><span class="p">,</span> <span class="s1">&#39;Eve&#39;</span><span class="p">])</span>
<span class="n">dict_values</span><span class="p">([</span><span class="mi">80</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">75</span><span class="p">])</span>
<span class="n">dict_items</span><span class="p">([(</span><span class="s1">&#39;Alice&#39;</span><span class="p">,</span> <span class="mi">80</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Bob&#39;</span><span class="p">,</span> <span class="mi">95</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Craig&#39;</span><span class="p">,</span> <span class="mi">56</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Dave&#39;</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;Eve&#39;</span><span class="p">,</span> <span class="mi">75</span><span class="p">)])</span>
</pre></div>
</div>
</div>
<p>The exercises below use
<a class="reference external" href="https://docs.python.org/3/tutorial/controlflow.html#if-statements">if-statements</a>.</p>
<div class="admonition-optional-exercise-homework-removing-duplicates exercise important admonition" id="exercise-2">
<p class="admonition-title">Optional exercise/ homework: removing duplicates</p>
<ul>
<li><p>This list contains duplicates:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Write a function which removes duplicates from the list and sorts the list.
In this case it would produce:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">17</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition-solution-1-longer-but-hopefully-easier-to-understand solution important dropdown admonition" id="solution-3">
<p class="admonition-title">Solution 1 (longer but hopefully easier to understand)</p>
<p>The function <code class="docutils literal notranslate"><span class="pre">sorted</span></code> sorts a sequence but it creates a new sequence.
This is useful if you need a sorted result without changing the original sequence.</p>
<p>We could have achieved the same result with <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list.sort" title="(in Python v3.13)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">list.sort()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">remove_duplicates_and_sort</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">new_sequence</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">element</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">new_sequence</span><span class="p">:</span>
            <span class="n">new_sequence</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">new_sequence</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-solution-2-more-compact solution important dropdown admonition" id="solution-4">
<p class="admonition-title">Solution 2 (more compact)</p>
<p>Converting to set removes duplicates.
Then we convert back to list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">remove_duplicates_and_sort</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">new_sequence</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">new_sequence</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-optional-exercise-homework-counting-how-often-an-item-appears exercise important admonition" id="exercise-3">
<p class="admonition-title">Optional exercise/ homework: counting how often an item appears</p>
<ul>
<li><p>Back to our list with duplicates:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">measurements</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Your goal is to write a function which will return a dictionary mapping each
number to how often it appears.
In this case it would produce:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">2</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">17</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">13</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">14</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="admonition-solution-1-longer-but-hopefully-easier-to-understand solution important dropdown admonition" id="solution-5">
<p class="admonition-title">Solution 1 (longer but hopefully easier to understand)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">how_often</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">counts</span><span class="p">:</span>
            <span class="n">counts</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">counts</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">counts</span>
</pre></div>
</div>
</div>
<div class="admonition-solution-2-more-compact solution important dropdown admonition" id="solution-6">
<p class="admonition-title">Solution 2 (more compact)</p>
<p>The point of this solution is to show that
for such common operations, ready-made functions and objects
already exist and is is worth to check out the documentation
about the <a class="reference external" href="https://docs.python.org/3/library/collections.html">collections module</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">Counter</span><span class="p">,</span> <span class="n">defaultdict</span>


<span class="k">def</span><span class="w"> </span><span class="nf">how_often_alternative1</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">Counter</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">how_often_alternative2</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">counts</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">counts</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
</section>
<span id="document-jupyter"></span><section id="jupyter-notebooks">
<h3>Jupyter Notebooks<a class="headerlink" href="#jupyter-notebooks" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Know what it is</p></li>
<li><p>Create a new notebook and save it</p></li>
<li><p>Open existing notebooks from the web</p></li>
<li><p>Be able to create text/markdown cells, code cells, images, and equations</p></li>
<li><p>Know when to use a Jupyter Notebook for a Python project and when perhaps not to</p></li>
<li><p>We will build up
<a class="reference external" href="https://nbviewer.org/github/coderefinery/python-progression/blob/main/notebooks/first-notebook.ipynb">this notebook</a>
(spoiler alert!)</p></li>
</ul>
</div>
<p>[this lesson is adapted from <a class="reference external" href="https://coderefinery.github.io/jupyter/motivation/">https://coderefinery.github.io/jupyter/motivation/</a>]</p>
<section id="motivation-for-jupyter-notebooks">
<h4>Motivation for Jupyter Notebooks<a class="headerlink" href="#motivation-for-jupyter-notebooks" title="Link to this heading"></a></h4>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/medicean-stars.png"><img alt="Galileo's drawings of Jupiter and its Medicean Stars from Sidereus Nuncius" src="_images/medicean-stars.png" style="width: 50%;" />
</a>
<figcaption>
<p><span class="caption-text"><strong>One of the first notebooks: Galileo’s drawings of Jupiter and its Medicean
Stars</strong> from Sidereus Nuncius. Image courtesy of the History of Science
Collections, University of Oklahoma Libraries (CC-BY).</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p><strong>Code, text, equations, figures, plots</strong>, etc. are interleaved, creating a <em>computational narrative</em>.</p></li>
<li><p><a class="reference external" href="https://www.nature.com/articles/d41586-018-07196-1"><em>“an environment in which users execute code, see what happens, modify and
repeat in a kind of iterative conversation between researcher and
data”</em></a></p></li>
<li><p>The name “Jupyter” derives from Julia+Python+R, but today Jupyter kernels
exist for <a class="reference external" href="https://github.com/jupyter/jupyter/wiki/Jupyter-kernels">dozens of programming languages</a>.</p></li>
<li><p><a class="reference external" href="https://github.com/jupyter/jupyter/wiki">Gallery of interesting Jupyter Notebooks</a>.</p></li>
</ul>
</section>
<section id="our-first-notebook">
<h4>Our first notebook<a class="headerlink" href="#our-first-notebook" title="Link to this heading"></a></h4>
<div class="admonition-exercise-create-a-notebook-15-min exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Create a notebook (15 min)</p>
<ul>
<li><p>Open a new notebook (if you are unsure how, have a look at <a class="reference internal" href="#document-installation"><span class="doc">Software install instructions</span></a>)</p></li>
<li><p>Rename the notebook</p></li>
<li><p>Create a <strong>markdown cell</strong> with a section title, a short text, an image, and an equation</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span><span class="gh"># Title of my notebook</span>

Some text.

![<span class="nt">Photo of Galilei&#39;s manuscript</span>](<span class="na">https://upload.wikimedia.org/wikipedia/commons/b/b3/Galileo_Galilei_%281564_-_1642%29_-_Serenissimo_Principe_-_manuscript_with_observations_of_Jupiter_and_four_of_its_moons%2C_1610.png</span>)

$E = mc^2$
</pre></div>
</div>
</li>
<li><p>Most important shortcut: <strong>Shift + Enter</strong>, to run current cell and create a new one below.</p></li>
<li><p>Create a <strong>code cell</strong> where you define the <code class="docutils literal notranslate"><span class="pre">arithmetic_mean</span></code> function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">arithmetic_mean</span><span class="p">(</span><span class="n">sequence</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">+=</span> <span class="n">element</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">s</span> <span class="o">/</span> <span class="n">n</span>
</pre></div>
</div>
</li>
<li><p>In a different cell, call the function:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">arithmetic_mean</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>In a new cell, let us try to plot a layered histogram:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># this example is from https://altair-viz.github.io/gallery/layered_histogram.html</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">altair</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">alt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># Generating Data</span>
<span class="n">source</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Trial A&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;Trial B&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span>
    <span class="s1">&#39;Trial C&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="p">})</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">source</span><span class="p">)</span><span class="o">.</span><span class="n">transform_fold</span><span class="p">(</span>
    <span class="p">[</span><span class="s1">&#39;Trial A&#39;</span><span class="p">,</span> <span class="s1">&#39;Trial B&#39;</span><span class="p">,</span> <span class="s1">&#39;Trial C&#39;</span><span class="p">],</span>
    <span class="n">as_</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Experiment&#39;</span><span class="p">,</span> <span class="s1">&#39;Measurement&#39;</span><span class="p">]</span>
<span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">(</span>
    <span class="n">opacity</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
    <span class="n">binSpacing</span><span class="o">=</span><span class="mi">0</span>
<span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s1">&#39;Measurement:Q&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">bin</span><span class="p">(</span><span class="n">maxbins</span><span class="o">=</span><span class="mi">100</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Y</span><span class="p">(</span><span class="s1">&#39;count()&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s1">&#39;Experiment:N&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Run all cells.</p></li>
<li><p>Save the notebook.</p></li>
<li><p>Observe that a “#” character has a different meaning in a code cell (code
comment) than in a markdown cell (heading).</p></li>
<li><p>Your notebook should look like <a class="reference external" href="https://nbviewer.org/github/coderefinery/python-progression/blob/main/notebooks/first-notebook.ipynb">this one</a>.</p></li>
</ul>
</div>
</section>
<section id="use-cases-for-notebooks">
<h4>Use cases for notebooks<a class="headerlink" href="#use-cases-for-notebooks" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Really good for step-by-step recipes (e.g. read data, filter data, do some statistics, plot the results)</p></li>
<li><p>Experimenting with new ideas, testing new libraries/databases</p></li>
<li><p>As an <em>interactive</em> development environment for code, data analysis, and visualization</p></li>
<li><p>Keeping track of interactive sessions, like a <strong>digital lab notebook</strong></p></li>
<li><p><strong>Supporting information with published articles</strong></p></li>
</ul>
<p>Situations where notebooks are less of a good fit:</p>
<ul class="simple">
<li><p>Code takes long to run</p></li>
<li><p>It is so long and complex that I need to test it</p></li>
<li><p>When I need a command-line interface</p></li>
<li><p>When I want to process many similar files and each takes few minutes</p></li>
</ul>
</section>
<section id="good-practices">
<h4>Good practices<a class="headerlink" href="#good-practices" title="Link to this heading"></a></h4>
<p><strong>Run all cells</strong> or even <strong>Restart Kernel and Run All Cells</strong>
before sharing/saving to verify that the results you see on your
computer were not due to cells being run out of order.</p>
<p>This can be demonstrated with the following example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">arithmetic_mean</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span>
</pre></div>
</div>
<p>We can first split this code into two cells and then re-define <code class="docutils literal notranslate"><span class="pre">numbers</span></code>
further down in the notebook. If we run the cells out of order, the result will
be different.</p>
</section>
</section>
<span id="document-tidy-data"></span><section id="data-formats-tidy-data-and-data-cleaning">
<h3>Data formats, tidy data, and data cleaning<a class="headerlink" href="#data-formats-tidy-data-and-data-cleaning" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Knowing about different storage formats</p></li>
<li><p>Knowing about the tidy data format</p></li>
<li><p>Be able to reformat tabular data into the tidy data format</p></li>
</ul>
</div>
<p>Data is not always in nicely formatted “plain” text files.
But sometimes the data is in a spreadsheet or in less nicely formatted text files.
In this episode we will discuss strategies for how to work with these.</p>
<section id="importing-data-from-spreadsheets">
<h4>Importing data from spreadsheets<a class="headerlink" href="#importing-data-from-spreadsheets" title="Link to this heading"></a></h4>
<p>We can create a spreadsheet with the following content (only columns A and B;
the actual content does not have to be exactly the same):</p>
<figure class="align-default" id="id1">
<img alt="An example spreadsheet with weekdays in one column and number of coffees in the other" src="_images/coffees.png" />
<figcaption>
<p><span class="caption-text">Example spreadsheet with a side note.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Copy this also to the second sheet and for demonstration purpose
add some side-notes to the second sheet and also color
one or two cells (some people like to give some meaning to cells using color).</p>
<p>Save the spreadsheet as <code class="docutils literal notranslate"><span class="pre">experiment.xls</span></code>.</p>
<p>Now we will together try to read and inspect both sheets in the Jupyter
Notebook:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;experiment.xls&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Sheet1&quot;</span><span class="p">)</span>
<span class="n">data</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;experiment.xls&#39;</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="s2">&quot;Sheet2&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<ul class="simple">
<li><p>We can import data from spreadsheets
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_excel.html">more documentation</a>)!</p></li>
<li><p>“Side notes” in spreadsheets can be annoying in this context.</p></li>
<li><p>Also encoding data in cell colors is a problem now. We will avoid those in
future.</p></li>
</ul>
</div>
</section>
<section id="tidy-data">
<h4>Tidy data<a class="headerlink" href="#tidy-data" title="Link to this heading"></a></h4>
<figure class="align-default" id="id2">
<img alt="An example spreadsheet not in tidy data format" src="_images/spreadsheet.png" />
<figcaption>
<p><span class="caption-text">Example spreadsheet (this is a phantasy dataset, apologies to biology
students/researchers - this is not my domain).</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-what-is-the-problem-with-storing-data-like-this discussion important admonition" id="discussion-1">
<p class="admonition-title">What is the problem with storing data like this?</p>
<ul class="simple">
<li><p>Format: Limited interoperability with other programs</p></li>
<li><p>Error prone (see e.g. <a class="reference external" href="https://www.theguardian.com/politics/2013/apr/18/uncovered-error-george-osborne-austerity">this famous example</a></p></li>
<li><p>Difficult to parse (“understand”) by scripts: difficult to automate</p></li>
<li><p>Not in <em>tidy format</em>: difficult to extend/modify</p></li>
</ul>
</div>
<p>How should we arrange the data?</p>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="_images/svalbard-compact.png"><img alt="Example data arranged in a compact representation" src="_images/svalbard-compact.png" style="width: 30%;" />
</a>
<figcaption>
<p><span class="caption-text">Attempt 1: Not great since we need to somehow divide at the comma. How should we deal with multiple sightings?</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id4">
<a class="reference internal image-reference" href="_images/svalbard-wide.png"><img alt="Example data arranged in a wide format" src="_images/svalbard-wide.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Attempt 2: Adding observation sites will force us to add columns.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id5">
<a class="reference internal image-reference" href="_images/svalbard-transposed.png"><img alt="Example data transposed" src="_images/svalbard-transposed.png" style="width: 60%;" />
</a>
<figcaption>
<p><span class="caption-text">Attempt 3: Adding species will force us to add columns.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id6">
<a class="reference internal image-reference" href="_images/svalbard-tidy.png"><img alt="Example data arranged in tidy data format" src="_images/svalbard-tidy.png" style="width: 50%;" />
</a>
<figcaption>
<p><span class="caption-text">Tidy data format: Columns are variables, rows are observations/measurements. Easy to add new species and sites.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-tidy-data-format keypoints admonition" id="keypoints-0">
<p class="admonition-title">Tidy data format</p>
<ul class="simple">
<li><p><a class="reference external" href="https://vita.had.co.nz/papers/tidy-data.html">Hadley Wickham: Tidy Data</a></p></li>
<li><p>Columns are variables</p></li>
<li><p>Rows are observations/measurements</p></li>
<li><p>“Long form”</p></li>
<li><p>Order does not matter</p></li>
<li><p><strong>Easy to extend</strong> with more species and more sites
without modifying the code</p></li>
<li><p><strong>Structure for storing data</strong> - this does not mean that this is ideal
for tables in presentations or publications</p></li>
<li><p>It is possible to convert between wide form and long form and back
(e.g. using <code class="docutils literal notranslate"><span class="pre">pandas.melt</span></code> or <code class="docutils literal notranslate"><span class="pre">pandas.pivot</span></code>), see <a class="reference external" href="https://nbviewer.org/github/coderefinery/python-progression/blob/main/notebooks/tidy-data.ipynb">this example notebook</a></p></li>
</ul>
</div>
</section>
<section id="use-a-standard-format">
<h4>Use a standard format<a class="headerlink" href="#use-a-standard-format" title="Link to this heading"></a></h4>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Species,Observation site,Number of sightings
arctic fox,A,3
arctic fox,B,1
walrus,B,1
walrus,C,1
reindeer,B,10
reindeer,C,1
polar bear,A,1
polar bear,C,1
seal,A,2
seal,B,1
seal,C,2
</pre></div>
</div>
<ul class="simple">
<li><p><strong>Use a format that is standard in your community, don’t invent your own</strong></p></li>
<li><p>CSV is often a good choice since most visualization tools can read CSV data</p></li>
</ul>
<p>There are many more formats (adapted after <a class="reference external" href="https://aaltoscicomp.github.io/python-for-scicomp/work-with-data/">Python for Scientific Computing</a>):</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Name:</p></th>
<th class="head"><p>Human<br>
readable:</p></th>
<th class="head"><p>Space<br>
efficiency:</p></th>
<th class="head"><p>Arbitrary<br>
data:</p></th>
<th class="head"><p>Tidy<br>
data:</p></th>
<th class="head"><p>Array<br>
data:</p></th>
<th class="head"><p>Long term<br>
storage/sharing:</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Comma-separated_values">CSV</a></p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>🟨</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://arrow.apache.org/docs/python/feather.html">Feather</a></p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://parquet.apache.org/">Parquet</a></p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>🟨</p></td>
<td><p>✅</p></td>
<td><p>🟨</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.lib.format.html">NPY</a></p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://en.wikipedia.org/wiki/Hierarchical_Data_Format">HDF5</a></p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://www.unidata.ucar.edu/software/netcdf/">NetCDF</a></p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://en.wikipedia.org/wiki/JSON">JSON</a></p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://geojson.org/">GeoJSON</a></p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p>Excel</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
</tr>
<tr class="row-odd"><td><p>Graph formats</p></td>
<td><p>🟨</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://en.wikipedia.org/wiki/SQL">SQL</a></p></td>
<td><p>❌</p></td>
<td><p>🟨</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>✅ : Good</p></li>
<li><p>🟨 : Ok / depends on a case</p></li>
<li><p>❌ : Bad</p></li>
</ul>
</div>
</section>
<section id="data-cleaning">
<h4>Data cleaning<a class="headerlink" href="#data-cleaning" title="Link to this heading"></a></h4>
<p>Often we want to visualize data sets with inconsistent or missing entries:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Date,Organization,Number of participants
2020-09-27,UiT,20
Oct 10 2020,UiT Norges arktiske universitet,15
&quot;Nov. 11, 2020&quot;,UiT The Arctic University of Norway,40
2020-12-12,UiT The Arctic University of Norway,-
</pre></div>
</div>
<p>Data cleaning is a bit outside the scope of this course
(although we have done some of this in the pandas episode) but still good to know:</p>
<ul class="simple">
<li><p>There are tools to clean and merge inconsistent data sets (e.g. <a class="reference external" href="https://openrefine.org/">OpenRefine</a>, see also
<a class="reference external" href="https://datacarpentry.org/OpenRefine-ecology-lesson/">this Data Carpentry lesson</a>)</p></li>
<li><p>This does not have to be done manually</p></li>
</ul>
</section>
</section>
<span id="document-plotting"></span><section id="plotting-with-vega-altair">
<h3>Plotting with <a class="reference external" href="https://altair-viz.github.io/">Vega-Altair</a><a class="headerlink" href="#plotting-with-vega-altair" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Be able to create simple plots with Vega-Altair and tweak them</p></li>
<li><p>Know how to look for help</p></li>
<li><p>Reading data with Pandas from disk or a web resource</p></li>
<li><p>Know how to tweak example plots from a gallery for your own purpose</p></li>
<li><p>We will build up
<a class="reference external" href="https://nbviewer.org/github/coderefinery/python-progression/blob/main/notebooks/plotting.ipynb">this notebook</a>
(spoiler alert!)</p></li>
</ul>
</div>
<section id="repeatability-reproducibility">
<h4>Repeatability/reproducibility<a class="headerlink" href="#repeatability-reproducibility" title="Link to this heading"></a></h4>
<p>From <a class="reference external" href="https://clauswilke.com/dataviz/">Claus O. Wilke: “Fundamentals of Data Visualization”</a>:</p>
<blockquote>
<div><p><em>One thing I have learned over the years is that automation is your friend. I
think figures should be autogenerated as part of the data analysis pipeline
(which should also be automated), and they should come out of the pipeline
ready to be sent to the printer, no manual post-processing needed.</em></p>
</div></blockquote>
<ul class="simple">
<li><p><strong>Try to minimize manual post-processing</strong>. This could bite you when you need to regenerate 50
figures one day before submission deadline or regenerate a set of figures
after the person who created them left the group.</p></li>
<li><p>There is not the one perfect language and <strong>not the one perfect library</strong> for everything.</p></li>
<li><p>Within Python, many libraries exist:</p>
<ul>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/index.html">Vega-Altair</a>:
declarative visualization, statistics built in</p></li>
<li><p><a class="reference external" href="https://matplotlib.org/stable/gallery/index.html">Matplotlib</a>:
probably the most standard and most widely used</p></li>
<li><p><a class="reference external" href="https://seaborn.pydata.org/examples/index.html">Seaborn</a>:
high-level interface to Matplotlib, statistical functions built in</p></li>
<li><p><a class="reference external" href="https://plotly.com/python/">Plotly</a>:
interactive graphs</p></li>
<li><p><a class="reference external" href="https://demo.bokeh.org/">Bokeh</a>:
also here good for interactivity</p></li>
<li><p><a class="reference external" href="https://plotnine.readthedocs.io/">plotnine</a>:
implementation of a grammar of graphics in Python, it is based on <a class="reference external" href="https://ggplot2.tidyverse.org/">ggplot2</a></p></li>
<li><p><a class="reference external" href="https://yhat.github.io/ggpy/">ggplot</a>:
R users will be more at home</p></li>
<li><p><a class="reference external" href="https://www.pyngl.ucar.edu/Examples/gallery.shtml">PyNGL</a>:
used in the weather forecast community</p></li>
<li><p><a class="reference external" href="https://k3d-jupyter.org/gallery/index.html">K3D</a>:
Jupyter Notebook extension for 3D visualization</p></li>
<li><p><a class="reference external" href="https://docs.enthought.com/mayavi/mayavi/">Mayavi</a>:
3D scientific data visualization and plotting in Python</p></li>
<li><p>…</p></li>
</ul>
</li>
<li><p>Two main families of libraries: procedural (e.g. Matplotlib) and declarative (e.g. Vega-Altair).</p></li>
</ul>
</section>
<section id="why-are-we-starting-with-vega-altair">
<h4>Why are we starting with <a class="reference external" href="https://altair-viz.github.io/">Vega-Altair</a>?<a class="headerlink" href="#why-are-we-starting-with-vega-altair" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Concise and powerful</p></li>
<li><p>“Simple, friendly and consistent API” allows us to focus on the data
visualization part and get started without too much Python knowledge</p></li>
<li><p>The way it <strong>combines visual channels with data columns</strong> can feel intuitive</p></li>
<li><p>Interfaces very nicely with <a class="reference external" href="https://pandas.pydata.org/">Pandas</a></p></li>
<li><p>Easy to change figures</p></li>
<li><p>Good documentation</p></li>
<li><p>Open source</p></li>
<li><p>Makes it easy to save figures in a number of formats (svg, png, html)</p></li>
<li><p>Easy to save interactive visualizations to be used in websites</p></li>
</ul>
</section>
<section id="example-data-weather-data-from-two-norwegian-cities">
<h4>Example data: Weather data from two Norwegian cities<a class="headerlink" href="#example-data-weather-data-from-two-norwegian-cities" title="Link to this heading"></a></h4>
<p>We will experiment with some example weather data obtained from <a class="reference external" href="https://seklima.met.no/observations/">Norsk
KlimaServiceSenter</a>, Meteorologisk
institutt (MET) (CC BY 4.0).  The data is in CSV format (comma-separated
values) and contains daily and monthly weather data for two cities in Norway:
Oslo and Tromsø. You can browse the data
<a class="reference external" href="https://github.com/coderefinery/python-progression/tree/main/data">here in the lesson repository</a>.</p>
<p>We will use the Pandas library to read the data into a dataframe.</p>
<p>Pandas can read from and write to a large set of formats
(<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/io.html">overview of input/output functions and formats</a>).
We will load a CSV file directly from the web. Instead of using a web URL we
could use a local file name instead.</p>
<p>Pandas dataframes are a great data structure for <strong>tabular data</strong> and tabular
data turns out to be a great input format for data visualization libraries.
Vega-Altair understands Pandas dataframes and can plot them directly.</p>
</section>
<section id="reading-data-into-a-dataframe">
<h4>Reading data into a dataframe<a class="headerlink" href="#reading-data-into-a-dataframe" title="Link to this heading"></a></h4>
<p>We can try this together in a notebook:
Using Pandas we can <strong>merge, join, concatenate, and compare</strong>
dataframes, see <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html">https://pandas.pydata.org/pandas-docs/stable/user_guide/merging.html</a>.</p>
<p>Let us try to <strong>concatenate</strong> two dataframes: one for Tromsø weather data (we
will now load monthly values) and one for Oslo:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">url_prefix</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/coderefinery/python-progression/main/data/&quot;</span>

<span class="n">data_tromso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url_prefix</span> <span class="o">+</span> <span class="s2">&quot;tromso-monthly.csv&quot;</span><span class="p">)</span>
<span class="n">data_oslo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url_prefix</span> <span class="o">+</span> <span class="s2">&quot;oslo-monthly.csv&quot;</span><span class="p">)</span>

<span class="hll"><span class="n">data_monthly</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_tromso</span><span class="p">,</span> <span class="n">data_oslo</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span>
<span class="c1"># let us print the combined result</span>
<span class="n">data_monthly</span>
</pre></div>
</div>
<p>Before plotting the data, there is a problem which we may not see yet: Dates
are not in a standard date format (YYYY-MM-DD). We can fix this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># replace mm.yyyy to date format</span>
<span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;%m.%Y&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>With Pandas it is possible to do a lot more (adjusting missing values, fixing
inconsistencies, changing format).</p>
</section>
<section id="what-is-in-a-dataframe">
<h4>What is in a dataframe?<a class="headerlink" href="#what-is-in-a-dataframe" title="Link to this heading"></a></h4>
<p>The name pandas is derived from the term “<strong>pan</strong>el <strong>da</strong>ta”.</p>
<figure class="align-default" id="id1">
<img alt="A pandas dataframe object is composed of rows and columns." src="_images/dataframe.svg" />
<figcaption>
<p><span class="caption-text">A pandas dataframe object is composed of rows and columns.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Let us explore these together in the notebook (run these in separate cells):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># print an overview of the dataset</span>
<span class="n">data_monthly</span>

<span class="c1"># print the first 5 rows</span>
<span class="n">data_monthly</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># print the last 5 rows</span>
<span class="n">data_monthly</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>

<span class="c1"># print all column titles - no parentheses here</span>
<span class="n">data_monthly</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># show which data types were detected</span>
<span class="n">data_monthly</span><span class="o">.</span><span class="n">dtypes</span>

<span class="c1"># print table dimensions - no parentheses here</span>
<span class="n">data_monthly</span><span class="o">.</span><span class="n">shape</span>

<span class="c1"># print one column</span>
<span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;max temperature&quot;</span><span class="p">]</span>

<span class="c1"># get some statistics</span>
<span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;max temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>

<span class="c1"># what was the maximum temperature?</span>
<span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;max temperature&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># print all rows where max temperature was above 20</span>
<span class="n">data_monthly</span><span class="p">[</span><span class="n">data_monthly</span><span class="p">[</span><span class="s2">&quot;max temperature&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">20.0</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="where-to-learn-more-about-pandas">
<h4>Where to learn more about pandas<a class="headerlink" href="#where-to-learn-more-about-pandas" title="Link to this heading"></a></h4>
<p>Pandas is extremely powerful and there is a lot that can be done and there are
great resources to explore more:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pandas.pydata.org/getting_started.html">Getting started guide</a>
(including tutorials and a 10 minute flash intro)</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/10min.html">10 minutes to pandas tutorial</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/">Pandas documentation</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf">Cheatsheet</a></p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/docs/user_guide/cookbook.html#cookbook">Cookbook</a></p></li>
<li><p><a class="reference external" href="https://datacarpentry.org/python-ecology-lesson/">Data Carpentry lesson</a> “Data Analysis and Visualization in Python for Ecologists”
(useful not only for ecologists)</p></li>
</ul>
</section>
<section id="plotting-the-data">
<h4>Plotting the data<a class="headerlink" href="#plotting-the-data" title="Link to this heading"></a></h4>
<p>Now let’s plot the data. We will start with a plot that is not optimal and
then we will explore and improve a bit as we go:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">altair</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">alt</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;precipitation&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id2">
<img alt="Monthly precipitation for the cities Oslo and Tromsø over the course of a year." src="_images/precipitation-on-top.svg" />
<figcaption>
<p><span class="caption-text">Monthly precipitation for the cities Oslo and Tromsø over the course of a year.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-let-us-pause-and-explain-the-code discussion important admonition" id="discussion-0">
<p class="admonition-title">Let us pause and explain the code</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">alt</span></code> is a short-hand for <code class="docutils literal notranslate"><span class="pre">altair</span></code> which we imported on top of the notebook</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Chart()</span></code> is a function defined inside <code class="docutils literal notranslate"><span class="pre">altair</span></code> which takes the data as argument</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mark_bar()</span></code> is a function that produces bar charts</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">encode()</span></code> is a function which encodes data columns to <strong>visual channels</strong></p></li>
</ul>
<p>Observe how we connect (encode) <strong>visual channels</strong> to data columns:</p>
<ul class="simple">
<li><p>x-coordinate with “date”</p></li>
<li><p>y-coordinate with “precipitation”</p></li>
<li><p>color with “name” (name of weather station; city)</p></li>
</ul>
</div>
<p>We can improve the plot by giving Vega-Altair a bit more information that the
x-axis is <strong>temporal</strong> (T) and that we would like to see the year and
month (yearmonth):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="hll">    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
</span>    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;precipitation&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Apart from T (temporal), there are other
<a class="reference external" href="https://altair-viz.github.io/user_guide/encodings/index.html#encoding-data-types">encoding data types</a>:</p>
<ul class="simple">
<li><p>Q (quantitative)</p></li>
<li><p>O (ordinal)</p></li>
<li><p>N (nominal)</p></li>
<li><p>T (temporal)</p></li>
<li><p>G (geojson)</p></li>
</ul>
<figure class="align-default" id="id3">
<img alt="Monthly precipitation for the cities Oslo and Tromsø over the course of a year." src="_images/precipitation-on-top-yearmonth.svg" />
<figcaption>
<p><span class="caption-text">Monthly precipitation for the cities Oslo and Tromsø over the course of a year.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Let us improve the plot with another one-line change:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;precipitation&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id4">
<img alt="Monthly precipitation for the cities Oslo and Tromsø over the course of a year with with both cities plotted side by side." src="_images/precipitation-side.svg" />
<figcaption>
<p><span class="caption-text">Monthly precipitation for the cities Oslo and Tromsø over the course of a year with with both cities plotted side by side.</span><a class="headerlink" href="#id4" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>With another one-line change we can make the bar chart stacked:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;precipitation&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">xOffset</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id5">
<img alt="Monthly precipitation for the cities Oslo and Tromsø over the course of a year with with both cities plotted side by side." src="_images/precipitation-stacked-x.svg" />
<figcaption>
<p><span class="caption-text">Monthly precipitation for the cities Oslo and Tromsø over the course of a year
plotted as stacked bar chart.</span><a class="headerlink" href="#id5" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>This is not publication-quality yet but a really good start!</p>
<p>Let us try one more example where we can nicely see how Vega-Altair
is able to map visual channels to data columns:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_area</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;max temperature&quot;</span><span class="p">,</span>
    <span class="n">y2</span><span class="o">=</span><span class="s2">&quot;min temperature&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id6">
<img alt="Monthly temperature ranges for two cities in Norway." src="_images/temperature-ranges-combined.svg" />
<figcaption>
<p><span class="caption-text">Monthly temperature ranges for two cities in Norway.</span><a class="headerlink" href="#id6" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-what-other-marks-and-other-visual-channels-exist discussion important admonition" id="discussion-1">
<p class="admonition-title">What other marks and other visual channels exist?</p>
<ul class="simple">
<li><p><a class="reference external" href="https://altair-viz.github.io/user_guide/marks/index.html">Overview of available marks</a></p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/user_guide/encodings/channels.html">Overview of available visual channels</a></p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/index.html">Gallery of examples</a></p></li>
</ul>
</div>
</section>
<section id="exercise-using-visual-channels-to-re-arrange-plots">
<h4>Exercise: Using visual channels to re-arrange plots<a class="headerlink" href="#exercise-using-visual-channels-to-re-arrange-plots" title="Link to this heading"></a></h4>
<div class="admonition-exercise-plotting-1-using-visual-channels-to-re-arrange-plots exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise Plotting-1: Using visual channels to re-arrange plots</p>
<ol class="arabic">
<li><p>Try to reproduce the above plots if they are not already in your notebook.</p></li>
<li><p>Above we have plotted the monthly precipitation for two cities side by side
using a stacked plot. Try to arrive at the following plot where months are
along the y-axis and the precipitation amount is along the x-axis:</p>
<figure class="align-default">
<img alt="_images/precipitation-stacked-y.svg" src="_images/precipitation-stacked-y.svg" />
</figure>
</li>
<li><p>Ask the Internet or AI how to change the axis title from “precipitation”
to “Precipitation (mm)”.</p></li>
<li><p>Modify the temperature range plot to show the temperature ranges for the
two cities side by side like this:</p>
<figure class="align-default">
<img alt="_images/temperature-ranges-side.svg" src="_images/temperature-ranges-side.svg" />
</figure>
</li>
</ol>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<ol class="arabic">
<li><p>Copy-paste code blocks from above.</p></li>
<li><p>Basically we switched x and y:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
<span class="hll">    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
</span><span class="hll">    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;precipitation&quot;</span><span class="p">,</span>
</span>    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">yOffset</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>This can be done with the following modification:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">x</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">X</span><span class="p">(</span><span class="s2">&quot;precipitation&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Precipitation (mm)&quot;</span><span class="p">),</span>
</span>    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
    <span class="n">yOffset</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>We added one line:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_monthly</span><span class="p">)</span><span class="o">.</span><span class="n">mark_area</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;yearmonth(date):T&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;max temperature&quot;</span><span class="p">,</span>
    <span class="n">y2</span><span class="o">=</span><span class="s2">&quot;min temperature&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
</section>
<section id="more-fun-with-visual-channels">
<h4>More fun with visual channels<a class="headerlink" href="#more-fun-with-visual-channels" title="Link to this heading"></a></h4>
<p>Now we will try to <strong>plot the daily data and look at snow depths</strong>. We first
read and concatenate two datasets:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">url_prefix</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/coderefinery/python-progression/main/data/&quot;</span>

<span class="n">data_tromso</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url_prefix</span> <span class="o">+</span> <span class="s2">&quot;tromso-daily.csv&quot;</span><span class="p">)</span>
<span class="n">data_oslo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url_prefix</span> <span class="o">+</span> <span class="s2">&quot;oslo-daily.csv&quot;</span><span class="p">)</span>

<span class="n">data_daily</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_tromso</span><span class="p">,</span> <span class="n">data_oslo</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>We adjust the data a bit:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># replace dd.mm.yyyy to date format</span>
<span class="n">data_daily</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">data_daily</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]),</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">.%m.%Y&quot;</span><span class="p">)</span>

<span class="c1"># we are here only interested in the range december to may</span>
<span class="n">data_daily</span> <span class="o">=</span> <span class="n">data_daily</span><span class="p">[</span>
    <span class="p">(</span><span class="n">data_daily</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="s2">&quot;2022-12-01&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">data_daily</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="s2">&quot;2023-05-01&quot;</span><span class="p">)</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Now we can plot the snow depths for the months December to May for the two
cities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_daily</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;snow depth&quot;</span><span class="p">,</span>
    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id7">
<img alt="Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway." src="_images/snow-depth.svg" />
<figcaption>
<p><span class="caption-text">Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway.</span><a class="headerlink" href="#id7" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>What happens if we try to color the plot by the “max temperature” values?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_daily</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;snow depth&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;max temperature&quot;</span><span class="p">,</span>
</span>    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The result looks neat:</p>
<figure class="align-default" id="id8">
<img alt="Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature." src="_images/snow-depth-color.svg" />
<figcaption>
<p><span class="caption-text">Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature.</span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>We can change the color scheme (<a class="reference external" href="https://vega.github.io/vega/docs/schemes/">available color schemes</a>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_daily</span><span class="p">)</span><span class="o">.</span><span class="n">mark_bar</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;snow depth&quot;</span><span class="p">,</span>
<span class="hll">    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;max temperature&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;plasma&quot;</span><span class="p">),</span>
</span>    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>With the following result:</p>
<figure class="align-default" id="id9">
<img alt="Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature. Warmer days are often followed by reduced snow depth." src="_images/snow-depth-plasma.svg" />
<figcaption>
<p><span class="caption-text">Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature. Warmer days are often followed by reduced snow depth.</span><a class="headerlink" href="#id9" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Let’s try one more change to show that we can experiment with different
plot types by changing <code class="docutils literal notranslate"><span class="pre">mark_bar()</span></code> to something else, in this case <code class="docutils literal notranslate"><span class="pre">mark_circle()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data_daily</span><span class="p">)</span><span class="o">.</span><span class="n">mark_circle</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
</span>    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;date&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;snow depth&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">Color</span><span class="p">(</span><span class="s2">&quot;max temperature&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="n">scheme</span><span class="o">=</span><span class="s2">&quot;plasma&quot;</span><span class="p">),</span>
    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;name&quot;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default" id="id10">
<img alt="Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature. Warmer days are often followed by reduced snow depth." src="_images/snow-depth-circles.svg" />
<figcaption>
<p><span class="caption-text">Snow depth (in cm) for the months December 2022 to May 2023 for two cities in Norway. Colored by daily max temperature. Warmer days are often followed by reduced snow depth.</span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="themes">
<h4>Themes<a class="headerlink" href="#themes" title="Link to this heading"></a></h4>
<p>In <a class="reference external" href="https://altair-viz.github.io/">Vega-Altair</a> you can change the theme and
select from a long <a class="reference external" href="https://github.com/vega/vega-themes">list of themes</a>.  On
top of your notebook try to add:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span><span class="o">.</span><span class="n">themes</span><span class="o">.</span><span class="n">enable</span><span class="p">(</span><span class="s1">&#39;dark&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then re-run all cells. Later you can try some other themes such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fivethirtyeight</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">latimes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">urbaninstitute</span></code></p></li>
</ul>
<p>You can even define your own themes!</p>
</section>
<section id="exercise-anscombe-s-quartet">
<h4>Exercise: Anscombe’s quartet<a class="headerlink" href="#exercise-anscombe-s-quartet" title="Link to this heading"></a></h4>
<p>Save the following data as <code class="docutils literal notranslate"><span class="pre">example.csv</span></code> (you can do this directly from
JupyterLab; this data is the <a class="reference external" href="https://en.wikipedia.org/wiki/Anscombe%27s_quartet">Anscombe’s
quartet</a>):</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>dataset,x,y
I,10.0,8.04
I,8.0,6.95
I,13.0,7.58
I,9.0,8.81
I,11.0,8.33
I,14.0,9.96
I,6.0,7.24
I,4.0,4.26
I,12.0,10.84
I,7.0,4.82
I,5.0,5.68
II,10.0,9.14
II,8.0,8.14
II,13.0,8.74
II,9.0,8.77
II,11.0,9.26
II,14.0,8.1
II,6.0,6.13
II,4.0,3.1
II,12.0,9.13
II,7.0,7.26
II,5.0,4.74
III,10.0,7.46
III,8.0,6.77
III,13.0,12.74
III,9.0,7.11
III,11.0,7.81
III,14.0,8.84
III,6.0,6.08
III,4.0,5.39
III,12.0,8.15
III,7.0,6.42
III,5.0,5.73
IV,8.0,6.58
IV,8.0,5.76
IV,8.0,7.71
IV,8.0,8.84
IV,8.0,8.47
IV,8.0,7.04
IV,8.0,5.25
IV,19.0,12.5
IV,8.0,5.56
IV,8.0,7.91
IV,8.0,6.89
</pre></div>
</div>
<div class="admonition-exercise-plotting-2-read-and-plot-a-csv-file exercise important admonition" id="exercise-1">
<p class="admonition-title">Exercise Plotting-2: Read and plot a CSV file</p>
<ul class="simple">
<li><p>Save the above CSV file to disk as <code class="docutils literal notranslate"><span class="pre">example.csv</span></code> in the same folder where
you run JupyterLab. We recommend to create the file in the JupyterLab
interface.</p></li>
<li><p>Plot the data using <code class="docutils literal notranslate"><span class="pre">mark_point</span></code>.</p></li>
<li><p>Your goal is to arrive at four plots for the four data sets, all side by side.</p></li>
<li><p>If you have time, try to customize the plot.</p></li>
</ul>
<div class="admonition-solution solution important dropdown admonition" id="solution-1">
<p class="admonition-title">Solution</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we don&#39;t need to import again but just in case you started here</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;example.csv&quot;</span><span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">,</span>
    <span class="n">column</span><span class="o">=</span><span class="s2">&quot;dataset&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Here is a more advanced example where the four plots are arranged
in a 2 x 2 grid:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">create_chart</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
    <span class="n">chart</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="o">.</span><span class="n">transform_filter</span><span class="p">(</span><span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">dataset</span> <span class="o">==</span> <span class="n">number</span><span class="p">)</span>
        <span class="o">.</span><span class="n">mark_point</span><span class="p">()</span>
        <span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">chart</span>


<span class="n">chart1</span> <span class="o">=</span> <span class="n">create_chart</span><span class="p">(</span><span class="n">data_example</span><span class="p">,</span> <span class="s2">&quot;I&quot;</span><span class="p">)</span>
<span class="n">chart2</span> <span class="o">=</span> <span class="n">create_chart</span><span class="p">(</span><span class="n">data_example</span><span class="p">,</span> <span class="s2">&quot;II&quot;</span><span class="p">)</span>
<span class="n">chart3</span> <span class="o">=</span> <span class="n">create_chart</span><span class="p">(</span><span class="n">data_example</span><span class="p">,</span> <span class="s2">&quot;III&quot;</span><span class="p">)</span>
<span class="n">chart4</span> <span class="o">=</span> <span class="n">create_chart</span><span class="p">(</span><span class="n">data_example</span><span class="p">,</span> <span class="s2">&quot;IV&quot;</span><span class="p">)</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">vconcat</span><span class="p">(</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">hconcat</span><span class="p">(</span><span class="n">chart1</span><span class="p">,</span> <span class="n">chart2</span><span class="p">),</span>
    <span class="n">alt</span><span class="o">.</span><span class="n">hconcat</span><span class="p">(</span><span class="n">chart3</span><span class="p">,</span> <span class="n">chart4</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">chart</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Browse a number of example galleries to help you choose the library
that fits best your work/style.</p></li>
<li><p>Minimize manual post-processing and try to script all steps.</p></li>
<li><p>CSV (comma-separated values) files are often a good format to store the data
that we wish to plot.</p></li>
<li><p>Read the data into a Pandas dataframe and then plot it with Vega-Altair
where you connect data columns to
<a class="reference external" href="https://altair-viz.github.io/user_guide/encodings/channels.html">visual channels</a>.</p></li>
</ul>
</div>
</section>
</section>
<span id="document-gallery"></span><section id="learning-how-to-adapt-existing-gallery-examples">
<h3>Learning how to adapt existing gallery examples<a class="headerlink" href="#learning-how-to-adapt-existing-gallery-examples" title="Link to this heading"></a></h3>
<p>In this exercise we can try to adapt existing scripts to either <strong>tweak how the
plot looks</strong> or to <strong>modify the input data</strong>.  This is very close to real life:
there are so many options and possibilities and it is almost impossible to
remember everything so this strategy is useful to practice:</p>
<ul class="simple">
<li><p>Select an example that is close to what you have in mind</p></li>
<li><p>Being able to adapt it to your needs</p></li>
<li><p>Being able to search for help</p></li>
</ul>
<div class="admonition-exercise-adapting-a-gallery-example exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Adapting a gallery example</p>
<p><strong>This is a great exercise which is very close to real life.</strong></p>
<ul class="simple">
<li><p>Browse the <a class="reference external" href="https://altair-viz.github.io/gallery/index.html">Vega-Altair example gallery</a>.</p></li>
<li><p>Select one example that is close to your current/recent visualization project
or simply interests you.</p></li>
<li><p>First try to reproduce this example, as-is, in the Jupyter Notebook.</p></li>
<li><p><strong>If you get the error “ModuleNotFoundError: No module named
‘vega_datasets’”, then try one of these examples:</strong> (they do not need the “vega_datasets” module)</p>
<ul>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/slider_cutoff.html">Slider cutoff</a>
(<strong>below you can find a walk-through for this example</strong>)</p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/multiline_tooltip_standard.html">Multi-Line tooltip</a></p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/simple_heatmap.html">Heatmap</a></p></li>
<li><p><a class="reference external" href="https://altair-viz.github.io/gallery/layered_histogram.html">Layered histogram</a></p></li>
</ul>
</li>
<li><p>Then try to print out the data that is used in this example just before the call of the plotting function
to learn about its structure. Consider writing the data to file before changing it.</p></li>
<li><p>Then try to modify the data a bit.</p></li>
<li><p>If you have time, try to feed it different, simplified data.
<strong>This will be key for adapting the examples to your projects.</strong></p></li>
</ul>
<div class="admonition-example-walk-through-for-the-slider-cutoff-example solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Example walk-through for the slider cutoff example</p>
<p>In this walk-through I imagine browsing: <a class="reference external" href="https://altair-viz.github.io/gallery/index.html">https://altair-viz.github.io/gallery/index.html</a></p>
<p>Then this example caught my eye: <a class="reference external" href="https://altair-viz.github.io/gallery/slider_cutoff.html">https://altair-viz.github.io/gallery/slider_cutoff.html</a></p>
<p>I then copy-paste the example code into a notebook and try to run it and I get
the same result.</p>
<p>Next, there is a lot of code that I don’t (need to) understand yet but my eyes are trying to find
<code class="docutils literal notranslate"><span class="pre">alt.Chart</span></code> which tells me that the data must be the “df” in <code class="docutils literal notranslate"><span class="pre">alt.Chart(df)</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">altair</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">alt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;xval&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;yval&#39;</span><span class="p">:</span> <span class="n">rand</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="p">})</span>

<span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="hll"><span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
</span>    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">xval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
<span class="p">)</span>
</pre></div>
</div>
<p>My next step will be to print out the data <code class="docutils literal notranslate"><span class="pre">df</span></code> just before the call to <code class="docutils literal notranslate"><span class="pre">alt.Chart</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">altair</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">alt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;xval&#39;</span><span class="p">:</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span>
    <span class="s1">&#39;yval&#39;</span><span class="p">:</span> <span class="n">rand</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
<span class="p">})</span>

<span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="hll"><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">xval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>The print reveals that <code class="docutils literal notranslate"><span class="pre">df</span></code> is a dataframe which contains x and y values:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>    xval       yval
0      0   0.496714
1      1   0.358450
2      2   1.006138
3      3   2.529168
4      4   2.295015
..   ...        ...
95    95 -10.712354
96    96 -10.416233
97    97 -10.155178
98    98 -10.150065
99    99 -10.384652

[100 rows x 2 columns]
</pre></div>
</div>
<p>The next thing that often helps me is to save the data to a comma-separated
values (CSV) file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data.csv&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>I then open the file in an editor and see that it contains 100 rows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>xval,yval
0,0.4967141530112327
1,0.358449851840048
2,1.0061383899407406
3,2.5291682463487657
4,2.2950148716254297
5,2.060877914676249
6,3.6400907301836405
7,4.407525459336549
8,3.938051073401597
9,4.4806111169875615
...
</pre></div>
</div>
<p>Saving the data to file often helps me to see the structure of the data and now
I am in a position to replace this with my own data. I create a file called
“mydata.csv” and there I use the maximum temperatures for months 1-10 from the
Tromso monthly data which we used further up:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>xval,yval
01,7.7
02,6.6
03,4.5
04,9.8
05,17.7
06,25.4
07,26.7
08,25.1
09,19.3
10,9.8
</pre></div>
</div>
<p>In the notebook I then verify that the reading of the data works:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mydata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;mydata.csv&quot;</span><span class="p">)</span>

<span class="n">mydata</span>
</pre></div>
</div>
<p>Now I can replace the example with my own data (note how I now can comment out
some code that I don’t need any longer):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">altair</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">alt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="c1"># import numpy as np</span>

<span class="c1"># rand = np.random.RandomState(42)</span>

<span class="c1"># df = pd.DataFrame({</span>
<span class="c1">#     &#39;xval&#39;: range(100),</span>
<span class="c1">#     &#39;yval&#39;: rand.randn(100).cumsum()</span>
<span class="c1"># })</span>

<span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>

<span class="c1"># print(df)</span>
<span class="hll"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;mydata.csv&quot;</span><span class="p">)</span>
</span>
<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">xval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>Seems to work! I then make few more adjustments (I want the slider to work on
the y-axis and have a more reasonable default):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">altair</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">alt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>

<span class="hll"><span class="n">slider</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">binding_range</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span class="hll"><span class="n">cutoff</span> <span class="o">=</span> <span class="n">alt</span><span class="o">.</span><span class="n">param</span><span class="p">(</span><span class="n">bind</span><span class="o">=</span><span class="n">slider</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;mydata.csv&quot;</span><span class="p">)</span>

<span class="n">alt</span><span class="o">.</span><span class="n">Chart</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">.</span><span class="n">mark_point</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s1">&#39;xval&#39;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s1">&#39;yval&#39;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="n">alt</span><span class="o">.</span><span class="n">condition</span><span class="p">(</span>
<span class="hll">        <span class="n">alt</span><span class="o">.</span><span class="n">datum</span><span class="o">.</span><span class="n">yval</span> <span class="o">&lt;</span> <span class="n">cutoff</span><span class="p">,</span>
</span>        <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">alt</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">add_params</span><span class="p">(</span>
    <span class="n">cutoff</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>My next steps would then be to change axis titles, display the month names, add
a legend, and refine from here.</p>
</div>
</div>
</section>
<span id="document-notebooks_to_scripts"></span><section id="from-notebooks-to-scripts">
<h3>From notebooks to scripts<a class="headerlink" href="#from-notebooks-to-scripts" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Understand when notebooks are not useful anymore and when to start using scripts</p></li>
<li><p>Be able to use <code class="docutils literal notranslate"><span class="pre">nbconvert</span></code> or other tools to convert a notebook to a script</p></li>
<li><p>Run a script from the command line</p></li>
<li><p>Reflect on the advantages of scripts over notebooks</p></li>
</ul>
</div>
<section id="why-make-the-change">
<h4>Why make the change?<a class="headerlink" href="#why-make-the-change" title="Link to this heading"></a></h4>
<p>Though we have seen that notebooks are very practical and useful for many tasks, such as testing out analyses, sharing results, teaching, and more, there are some cases where it is better to use scripts.</p>
<p>We will all at one point find out that notebooks are not the best tool for  every use. Some cases where a script would do a better job are:</p>
<ul class="simple">
<li><p>You want to run an analysis at a specific time every day, with a scheduler of some kind</p></li>
<li><p>Your notebook has exceeded your laptops capabilities and you want to migrate your workflow to a supercomputer with a scheduler such as SLURM</p></li>
<li><p>You run a complex process in the notebook needs to be optimized and profiled with the relevant tools (We will look at this more later in this course)</p></li>
</ul>
<p>Although scripts are not the perfect tool either, they are still a powerful tool and allow for more flexibility and control.</p>
</section>
<section id="converting-a-notebook-to-a-script">
<h4>Converting a notebook to a script<a class="headerlink" href="#converting-a-notebook-to-a-script" title="Link to this heading"></a></h4>
<p>There are several ways to make a notebook into a command line script. One such way is <code class="docutils literal notranslate"><span class="pre">nbconvert</span></code>, which is a tool that comes with Jupyter.
Check the <code class="docutils literal notranslate"><span class="pre">JupyterLab</span> <span class="pre">documentation</span> <span class="pre">&lt;https://jupyterlab.readthedocs.io/en/stable/user/export.html&gt;</span></code>for more information.</p>
<p>You can get a command line in jupyter lab by (File → New Launcher → Terminal - if you go through New Launcher, your command line will be in the directory you are currently browsing), you can convert files in the terminal by running:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w">  </span>jupyter<span class="w"> </span>nbconvert<span class="w"> </span>--to<span class="w"> </span>script<span class="w"> </span>your_notebook_name.ipynb
</pre></div>
</div>
<p>If you are struggling with the command line, you can also convert a notebook to a script by going to the notebook and clicking on <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">→</span> <span class="pre">Save</span> <span class="pre">and</span> <span class="pre">Export</span> <span class="pre">Notebook</span> <span class="pre">As</span> <span class="pre">→</span> <span class="pre">Executable</span> <span class="pre">Script</span></code>.
This will save the notebook in your machine, so you will have to copy it to the relevant directory (if you want it on a remote machine such as a supercomputer).</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/exporting-notebooks.png"><img alt="Exporting notebooks using the top menu bar in jupyter lab." src="_images/exporting-notebooks.png" style="width: 80%;" />
</a>
<figcaption>
<p><span class="caption-text">Press in the top menu <strong>File → Save and Export Notebook As → Executable Script</strong> to download the notebook as a script.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-exercise-scripts-1-convert-a-notebook-to-a-script-20-mins exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise Scripts-1: Convert a notebook to a script (20 mins)</p>
<ol class="arabic">
<li><p>Download the following notebook by right-clicking on <a class="reference external" href="https://nbviewer.org/github/coderefinery/python-progression/raw/main/notebooks/weather_observations.ipynb">this link</a> and selecting “Save Link As…” to save the file to your local machine.</p></li>
<li><p>Convert the notebook to a script using the terminal following the instructions above.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jupyter<span class="w"> </span>nbconvert<span class="w"> </span>--to<span class="w"> </span>script<span class="w"> </span>weather_observations.ipynb
</pre></div>
</div>
</li>
<li><p>Run the generated script in the terminal with:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>weather_observations.py
</pre></div>
</div>
</li>
</ol>
<p>Discussion:</p>
<ul class="simple">
<li><p>What changed when you converted the notebook to the script?</p></li>
<li><p>What would have happened if the notebook was not written with linear execution in mind?</p></li>
<li><p>what would you have to do if you wanted to change the date range for the plotting?</p></li>
<li><p>Is this something you think you can use in your work?</p></li>
</ul>
</div>
<p>There are some other ways of executing your notebook as a script, such as papermill, though we will not go through these today.</p>
<p>We can now move on to working with command line arguments in scripts, which is where scripts really shine.</p>
</section>
</section>
<span id="document-CLI"></span><section id="command-line-interfaces-cli">
<h3>Command-line interfaces (CLI)<a class="headerlink" href="#command-line-interfaces-cli" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Understand the basics of command-line interfaces</p></li>
<li><p>Learn how to write code that can change its behaviour based on command-line arguments</p></li>
</ul>
</div>
<p>In the previous section, we learned how to convert a Jupyter notebook into a Python script that is executable from the command line. Though we can now run it in the command line, every time we want to change something in the analysis we would need to edit the script.</p>
<p>In this section we will learn how to change the behaviour of a script based on command-line arguments. This will allow us to run the script with different parameters without having to edit the script every time.</p>
<p>This is useful when you want to share your script with other people, as they wont necesarilly need to know what is inside the script to run it.</p>
<section id="command-line-arguments-with-argparse">
<h4>Command-line arguments with <code class="docutils literal notranslate"><span class="pre">argparse</span></code><a class="headerlink" href="#command-line-arguments-with-argparse" title="Link to this heading"></a></h4>
<p>Command-line arguments are parameters that are passed to a script when running it in the command line.
An example of this is:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>my_script.py<span class="w"> </span>arg1<span class="w"> </span>arg2
</pre></div>
</div>
<p>In this case, <code class="docutils literal notranslate"><span class="pre">arg1</span></code> and <code class="docutils literal notranslate"><span class="pre">arg2</span></code> are the command-line arguments that are passed to the script <code class="docutils literal notranslate"><span class="pre">my_script.py</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">argparse</span></code> is a Python module that makes it easy to write descriptive command-line arguments, and it also automatically writes useful <code class="docutils literal notranslate"><span class="pre">--help</span></code>sections for your script.</p>
<p><code class="docutils literal notranslate"><span class="pre">argparse</span></code> defines two types of arguments:</p>
<ul class="simple">
<li><p>Positional arguments: these are required arguments that are passed to the script in a specific order.</p></li>
<li><p>Optional arguments: these are arguments that are not required and can be passed in any order.</p></li>
</ul>
<p>To use argparse you first set up a parser by calling <code class="docutils literal notranslate"><span class="pre">parser</span> <span class="pre">=</span> <span class="pre">argparse.ArgumentParser()</span></code> and then you add arguments using <code class="docutils literal notranslate"><span class="pre">parser.add_argument(args)</span></code>.</p>
<p>Lets write an example script that takes in a name and a birth date as arguments and prints them out.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>

<span class="c1"># Initialize the parser</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>

<span class="c1"># One positional and one optional argument</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s2">&quot;N&quot;</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;The name of the subject&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="s1">&#39;--date&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">string</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;01/01/2000&quot;</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Birth date of the subject&quot;</span><span class="p">)</span>

<span class="c1"># Parse the arguments and collect them in args</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s2">&quot; was born on &quot;</span> <span class="o">+</span> <span class="n">args</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
</pre></div>
</div>
<p>when this is run you have to pass in the name and the date as arguments in this way:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>birthday.py<span class="w"> </span>John<span class="w"> </span>-d<span class="w"> </span><span class="m">01</span>/01/1990
</pre></div>
</div>
<p>If you run the script without the date argument, it will default to the date specified in the <code class="docutils literal notranslate"><span class="pre">add_argument</span></code> function.</p>
<p>If you run the script with the <code class="docutils literal notranslate"><span class="pre">--help</span></code> flag, you will get a description of the arguments that the script takes in:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>birthday.py<span class="w"> </span>--help
</pre></div>
</div>
<p>which would return:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">birthday</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">d</span> <span class="n">DATE</span><span class="p">]</span> <span class="n">N</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="n">N</span>                     <span class="n">The</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">subject</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">-</span><span class="n">d</span> <span class="n">DATE</span><span class="p">,</span> <span class="o">--</span><span class="n">date</span> <span class="n">DATE</span>  <span class="n">Birth</span> <span class="n">date</span> <span class="n">of</span> <span class="n">the</span> <span class="n">subject</span>

</pre></div>
</div>
<p>Lets now try</p>
<div class="admonition-exercise-scripts-2-add-command-line-arguments-to-a-script-15-mins exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise Scripts-2: Add command-line arguments to a script (15 mins)</p>
<p>Use the example above edit the script <code class="docutils literal notranslate"><span class="pre">weather_observations.py</span></code> from the previous exercise to take in the date range as arguments using <code class="docutils literal notranslate"><span class="pre">argparse</span></code>.</p>
<ul>
<li><p>Hint: The script should be able to be run like this:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>weather_observations.py<span class="w"> </span>--start<span class="w"> </span><span class="m">2020</span>-01-01<span class="w"> </span>--end<span class="w"> </span><span class="m">2020</span>-12-31<span class="w">  </span>
</pre></div>
</div>
</li>
<li><p>Hint: try not to do it all at once, but add one or two arguments, test, then add more, and so on.</p></li>
<li><p>Hint: The input and output filenames make sense as positional arguments, since they must always be given. Input is usually first, then output.</p></li>
<li><p>Hint: The start and end dates should be optional parameters with the defaults as they are in the current script.</p></li>
</ul>
<p>Discussion:</p>
<ul class="simple">
<li><p>What was the main challenge in adding the arguments?</p></li>
<li><p>What would you have to do if you wanted to add more arguments? or a new analysis?</p></li>
<li><p>How would you work with the arguments in for example a slurm submit script?</p></li>
</ul>
</div>
<p>This is not the only way to add command-line arguments to a script. We encourage you to explore other ways to do this, such as using <code class="docutils literal notranslate"><span class="pre">sys.argv</span></code>, <code class="docutils literal notranslate"><span class="pre">doctopt</span></code>, <code class="docutils literal notranslate"><span class="pre">typer</span></code> or <code class="docutils literal notranslate"><span class="pre">click</span></code>.</p>
</section>
</section>
<span id="document-good-practices"></span><section id="good-practices-and-tools">
<h3>Good practices and tools<a class="headerlink" href="#good-practices-and-tools" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>How does good Python code look like? And if we only had 30 minutes, which
good practices should we highlight?</p></li>
<li><p>Some of the points are inspired by the excellent <a class="reference external" href="https://effectivepython.com/">Effective Python</a> book by Brett Slatkin.</p></li>
</ul>
</div>
<section id="follow-the-pep-8-style-guide">
<h4>Follow the PEP 8 style guide<a class="headerlink" href="#follow-the-pep-8-style-guide" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Please browse the <a class="reference external" href="https://pep8.org/">PEP 8 style guide</a> so that you are familiar with the most important rules.</p></li>
<li><p>Using a consistent style makes your code easier to read and understand for others.</p></li>
<li><p>You don’t have to check and adjust your code manually. There are tools that can do this for you (see below).</p></li>
</ul>
</section>
<section id="linting-and-static-type-checking">
<h4>Linting and static type checking<a class="headerlink" href="#linting-and-static-type-checking" title="Link to this heading"></a></h4>
<p>A <strong>linter</strong> is a tool that analyzes source code to detect potential errors, unused
imports, unused variables, code style violations, and to improve readability.</p>
<ul class="simple">
<li><p>Popular linters:</p>
<ul>
<li><p><a class="reference external" href="https://pypi.org/project/autoflake/">Autoflake</a></p></li>
<li><p><a class="reference external" href="https://flake8.pycqa.org/">Flake8</a></p></li>
<li><p><a class="reference external" href="https://pypi.org/project/pyflakes/">Pyflakes</a></p></li>
<li><p><a class="reference external" href="https://pycodestyle.pycqa.org/">Pycodestyle</a></p></li>
<li><p><a class="reference external" href="https://pylint.readthedocs.io/">Pylint</a></p></li>
<li><p><a class="reference external" href="https://docs.astral.sh/ruff/">Ruff</a></p></li>
</ul>
</li>
</ul>
<p>We recommend <a class="reference external" href="https://docs.astral.sh/ruff/">Ruff</a> since it
can do <strong>both checking and formatting</strong> and you don’t have to switch between
multiple tools.</p>
<div class="admonition-linters-and-formatters-can-be-configured-to-your-liking discussion important admonition" id="discussion-0">
<p class="admonition-title">Linters and formatters can be configured to your liking</p>
<p>These tools typically have good defaults. But if you don’t like the defaults,
you can configure what they should ignore or how they should format or not format.</p>
</div>
<p>This code example (which we possibly recognize from the previous section about
<a class="reference internal" href="#document-profiling"><span class="doc">Profiling</span></a>)
has few problems (highlighted):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="hll"><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
</span>

<span class="k">def</span><span class="w"> </span><span class="nf">count_unique_words</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">unique_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="hll">    <span class="n">forgotten_variable</span> <span class="o">=</span> <span class="mi">13</span>
</span>    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
<span class="hll">            <span class="n">words</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\b\w+\b&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">()))</span>
</span>            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="n">unique_words</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_words</span><span class="p">)</span>
</pre></div>
</div>
<p>Please try whether you can locate these problems using Ruff:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ruff<span class="w"> </span>check
</pre></div>
</div>
<p>If you use version control and like to have your code checked or formatted
<strong>before you commit the change</strong>, you can use tools like <a class="reference external" href="https://pre-commit.com/">pre-commit</a>.</p>
<p>Many editors can be configured to automatically check your code as you type. Ruff can also
be used as a <strong>language server</strong>.</p>
</section>
<section id="use-an-auto-formatter">
<h4>Use an auto-formatter<a class="headerlink" href="#use-an-auto-formatter" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://docs.astral.sh/ruff/">Ruff</a> is one of the best tools to automatically
format your code according to a consistent style.</p>
<p>To demonstrate how it works, let us try to auto-format a code example which is badly formatted and also difficult
to read:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">Badly formatted</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">Auto-formatted</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
<span class="k">def</span><span class="w">  </span><span class="nf">count_unique_words</span> <span class="p">(</span><span class="n">file_path</span> <span class="p">:</span> <span class="nb">str</span><span class="p">)</span><span class="o">-&gt;</span><span class="nb">int</span><span class="p">:</span>
  <span class="n">unique_words</span><span class="o">=</span><span class="nb">set</span><span class="p">()</span>
  <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
      <span class="n">words</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\b\w+\b&quot;</span><span class="p">,</span><span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
      <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
        <span class="n">unique_words</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
  <span class="k">return</span> <span class="nb">len</span><span class="p">(</span>   <span class="n">unique_words</span>   <span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>


<span class="k">def</span><span class="w"> </span><span class="nf">count_unique_words</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">unique_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\b\w+\b&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="n">unique_words</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_words</span><span class="p">)</span>
</pre></div>
</div>
<p>This was done using:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ruff<span class="w"> </span>format
</pre></div>
</div>
</div></div>
<p>Other popular formatters:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://black.readthedocs.io/">Black</a></p></li>
<li><p><a class="reference external" href="https://github.com/google/yapf">YAPF</a></p></li>
</ul>
<p>Many editors can be configured to automatically format for you when you save the file.</p>
<p>It is possible to automatically format your code in Jupyter notebooks!
For this to work you need
the following three dependencies installed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupyterlab</span><span class="o">-</span><span class="n">code</span><span class="o">-</span><span class="n">formatter</span>
<span class="n">black</span>
<span class="n">isort</span>
</pre></div>
</div>
<p>More information and a screen-cast of how this works can be found at
<a class="reference external" href="https://jupyterlab-code-formatter.readthedocs.io/">https://jupyterlab-code-formatter.readthedocs.io/</a>.</p>
</section>
<section id="consider-annotating-your-functions-with-type-hints">
<h4>Consider annotating your functions with type hints<a class="headerlink" href="#consider-annotating-your-functions-with-type-hints" title="Link to this heading"></a></h4>
<p>Compare these two versions of the same function and discuss how the type hints
can help you and the Python interpreter to understand the function better:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">Without type hints</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">With type hints</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="k">def</span><span class="w"> </span><span class="nf">count_unique_words</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
</span>    <span class="n">unique_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\b\w+\b&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="n">unique_words</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_words</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="k">def</span><span class="w"> </span><span class="nf">count_unique_words</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
</span>    <span class="n">unique_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\b\w+\b&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="n">unique_words</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_words</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
<p>A (static) type checker is a tool that checks whether the types of variables in your
code match the types that you have specified.
Popular tools:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://mypy.readthedocs.io/">Mypy</a></p></li>
<li><p><a class="reference external" href="https://github.com/microsoft/pyright">Pyright</a> (Microsoft)</p></li>
<li><p><a class="reference external" href="https://pyre-check.org/">Pyre</a> (Meta)</p></li>
</ul>
</section>
<section id="consider-using-ai-assisted-coding">
<h4>Consider using AI-assisted coding<a class="headerlink" href="#consider-using-ai-assisted-coding" title="Link to this heading"></a></h4>
<p>We can use AI as an assistant/apprentice:</p>
<ul class="simple">
<li><p>Code completion</p></li>
<li><p>Write a test based on an implementation</p></li>
<li><p>Write an implementation based on a test</p></li>
</ul>
<p>Or we can use AI as a mentor:</p>
<ul class="simple">
<li><p>Explain a concept</p></li>
<li><p>Improve code</p></li>
<li><p>Show a different (possibly better) way of implementing the same thing</p></li>
</ul>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="_images/chatgpt.png"><img alt="Screenshot of ChatGPT" src="_images/chatgpt.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Example for using a chat-based AI tool.</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id3">
<a class="reference internal image-reference" href="_images/code-completion.gif"><img alt="Screen-cast of working with GitHub Copilot" src="_images/code-completion.gif" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Example for using AI to complete code in an editor.</span><a class="headerlink" href="#id3" title="Link to this image"></a></p>
</figcaption>
</figure>
<div class="admonition-ai-tools-open-up-a-box-of-questions-which-are-beyond-our-scope-here admonition">
<p class="admonition-title">AI tools open up a box of questions which are beyond our scope here</p>
<ul class="simple">
<li><p>Legal</p></li>
<li><p>Ethical</p></li>
<li><p>Privacy</p></li>
<li><p>Lock-in/ monopolies</p></li>
<li><p>Lack of diversity</p></li>
<li><p>Will we still need to learn programming?</p></li>
<li><p>How will it affect learning and teaching programming?</p></li>
</ul>
</div>
</section>
<section id="debugging-with-print-statements">
<h4>Debugging with print statements<a class="headerlink" href="#debugging-with-print-statements" title="Link to this heading"></a></h4>
<p>Print-debugging is a simple, effective, and popular way to debug your code like
this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;file_path: </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Or more elaborate:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;I am in function count_unique_words and the value of file_path is </span><span class="si">{</span><span class="n">file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>But there can be better alternatives:</p>
<ul>
<li><p><a class="reference external" href="https://docs.python.org/3/library/logging.html">Logging</a> module</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">logging</span>

<span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>

<span class="n">logging</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;This is a debug message&quot;</span><span class="p">)</span>
<span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;This is an info message&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://github.com/gruns/icecream">IceCream</a> offers compact helper functions for print-debugging</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">icecream</span><span class="w"> </span><span class="kn">import</span> <span class="n">ic</span>

<span class="n">ic</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</section>
<section id="often-you-can-avoid-using-indices">
<h4>Often you can avoid using indices<a class="headerlink" href="#often-you-can-avoid-using-indices" title="Link to this heading"></a></h4>
<p>Especially people coming to Python from other languages tend to use indices
where they are not needed. Indices can be error-prone (off-by-one errors and
reading/writing past the end of the collection).</p>
<section id="iterating">
<h5>Iterating<a class="headerlink" href="#iterating" title="Link to this heading"></a></h5>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">Verbose and can be brittle</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">Better</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">scores</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">scores</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">score</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</section>
<section id="enumerate-if-you-need-the-index">
<h5>Enumerate if you need the index<a class="headerlink" href="#enumerate-if-you-need-the-index" title="Link to this heading"></a></h5>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">Verbose and can be brittle</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">Better</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">particle_masses</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">8.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">particle_masses</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Particle </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> has mass </span><span class="si">{</span><span class="n">particle_masses</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">particle_masses</span> <span class="o">=</span> <span class="p">[</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">2.2</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">,</span> <span class="mf">8.1</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">mass</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">particle_masses</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Particle </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> has mass </span><span class="si">{</span><span class="n">mass</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</section>
<section id="zip-if-you-need-to-iterate-over-two-collections">
<h5>Zip if you need to iterate over two collections<a class="headerlink" href="#zip-if-you-need-to-iterate-over-two-collections" title="Link to this heading"></a></h5>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-4-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-4-4-0" name="4-0" role="tab" tabindex="0">Using an index can be brittle</button><button aria-controls="panel-4-4-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-4-4-1" name="4-1" role="tab" tabindex="-1">Better</button></div><div aria-labelledby="tab-4-4-0" class="sphinx-tabs-panel" id="panel-4-4-0" name="4-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">persons</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">,</span> <span class="s2">&quot;David&quot;</span><span class="p">,</span> <span class="s2">&quot;Eve&quot;</span><span class="p">]</span>
<span class="n">favorite_ice_creams</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vanilla&quot;</span><span class="p">,</span> <span class="s2">&quot;chocolate&quot;</span><span class="p">,</span> <span class="s2">&quot;strawberry&quot;</span><span class="p">,</span> <span class="s2">&quot;mint&quot;</span><span class="p">,</span> <span class="s2">&quot;chocolate&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">persons</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">persons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> likes </span><span class="si">{</span><span class="n">favorite_ice_creams</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2"> ice cream&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-4-1" class="sphinx-tabs-panel" hidden="true" id="panel-4-4-1" name="4-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">persons</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="s2">&quot;Charlie&quot;</span><span class="p">,</span> <span class="s2">&quot;David&quot;</span><span class="p">,</span> <span class="s2">&quot;Eve&quot;</span><span class="p">]</span>
<span class="n">favorite_ice_creams</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;vanilla&quot;</span><span class="p">,</span> <span class="s2">&quot;chocolate&quot;</span><span class="p">,</span> <span class="s2">&quot;strawberry&quot;</span><span class="p">,</span> <span class="s2">&quot;mint&quot;</span><span class="p">,</span> <span class="s2">&quot;chocolate&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">person</span><span class="p">,</span> <span class="n">flavor</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">persons</span><span class="p">,</span> <span class="n">favorite_ice_creams</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">person</span><span class="si">}</span><span class="s2"> likes </span><span class="si">{</span><span class="n">flavor</span><span class="si">}</span><span class="s2"> ice cream&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></div>
</section>
<section id="unpacking">
<h5>Unpacking<a class="headerlink" href="#unpacking" title="Link to this heading"></a></h5>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-5-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-5-5-0" name="5-0" role="tab" tabindex="0">Verbose and can be brittle</button><button aria-controls="panel-5-5-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-5-5-1" name="5-1" role="tab" tabindex="-1">Better</button></div><div aria-labelledby="tab-5-5-0" class="sphinx-tabs-panel" id="panel-5-5-0" name="5-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">coordinates</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-5-1" class="sphinx-tabs-panel" hidden="true" id="panel-5-5-1" name="5-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">coordinates</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">coordinates</span>
</pre></div>
</div>
</div></div>
</section>
<section id="prefer-catch-all-unpacking-over-indexing-slicing">
<h5>Prefer catch-all unpacking over indexing/slicing<a class="headerlink" href="#prefer-catch-all-unpacking-over-indexing-slicing" title="Link to this heading"></a></h5>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-6-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-6-6-0" name="6-0" role="tab" tabindex="0">Verbose and can be brittle</button><button aria-controls="panel-6-6-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-6-6-1" name="6-1" role="tab" tabindex="-1">Better</button></div><div aria-labelledby="tab-6-6-0" class="sphinx-tabs-panel" id="panel-6-6-0" name="6-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">sorted_scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>

<span class="n">smallest</span> <span class="o">=</span> <span class="n">sorted_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">rest</span> <span class="o">=</span> <span class="n">sorted_scores</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">largest</span> <span class="o">=</span> <span class="n">sorted_scores</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">smallest</span><span class="p">,</span> <span class="n">rest</span><span class="p">,</span> <span class="n">largest</span><span class="p">)</span>
<span class="c1"># Output: 2 [3, 3, 4, 5] 13</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-6-1" class="sphinx-tabs-panel" hidden="true" id="panel-6-6-1" name="6-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scores</span> <span class="o">=</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>

<span class="n">sorted_scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>

<span class="n">smallest</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">,</span> <span class="n">largest</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">smallest</span><span class="p">,</span> <span class="n">rest</span><span class="p">,</span> <span class="n">largest</span><span class="p">)</span>
<span class="c1"># Output: 2 [3, 3, 4, 5] 13</span>
</pre></div>
</div>
</div></div>
</section>
<section id="list-comprehensions-map-and-filter-instead-of-loops">
<h5>List comprehensions, map, and filter instead of loops<a class="headerlink" href="#list-comprehensions-map-and-filter-instead-of-loops" title="Link to this heading"></a></h5>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-7-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-7-7-0" name="7-0" role="tab" tabindex="0">For-loop</button><button aria-controls="panel-7-7-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-7-7-1" name="7-1" role="tab" tabindex="-1">List comprehension</button><button aria-controls="panel-7-7-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-7-7-2" name="7-2" role="tab" tabindex="-1">Map</button></div><div aria-labelledby="tab-7-7-0" class="sphinx-tabs-panel" id="panel-7-7-0" name="7-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">string_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">]</span>

<span class="n">integer_numbers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">string_numbers</span><span class="p">:</span>
    <span class="n">integer_numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">integer_numbers</span><span class="p">)</span>
<span class="c1"># Output: [1, 2, 3, 4, 5]</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-7-1" class="sphinx-tabs-panel" hidden="true" id="panel-7-7-1" name="7-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">string_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">]</span>

<span class="n">integer_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">element</span><span class="p">)</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">string_numbers</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">integer_numbers</span><span class="p">)</span>
<span class="c1"># Output: [1, 2, 3, 4, 5]</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-7-2" class="sphinx-tabs-panel" hidden="true" id="panel-7-7-2" name="7-2" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">string_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;2&quot;</span><span class="p">,</span> <span class="s2">&quot;3&quot;</span><span class="p">,</span> <span class="s2">&quot;4&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">]</span>

<span class="n">integer_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">string_numbers</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">integer_numbers</span><span class="p">)</span>
<span class="c1"># Output: [1, 2, 3, 4, 5]</span>
</pre></div>
</div>
</div></div>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-8-8-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-8-8-0" name="8-0" role="tab" tabindex="0">For-loop</button><button aria-controls="panel-8-8-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-8-8-1" name="8-1" role="tab" tabindex="-1">List comprehension</button><button aria-controls="panel-8-8-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-8-8-2" name="8-2" role="tab" tabindex="-1">Filter</button></div><div aria-labelledby="tab-8-8-0" class="sphinx-tabs-panel" id="panel-8-8-0" name="8-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">is_even</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>


<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="n">even_numbers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">is_even</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
        <span class="n">even_numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">even_numbers</span><span class="p">)</span>
<span class="c1"># Output: [2, 4, 6]</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-8-1" class="sphinx-tabs-panel" hidden="true" id="panel-8-8-1" name="8-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">is_even</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>


<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="n">even_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="n">number</span> <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span> <span class="k">if</span> <span class="n">is_even</span><span class="p">(</span><span class="n">number</span><span class="p">)]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">even_numbers</span><span class="p">)</span>
<span class="c1"># Output: [2, 4, 6]</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-8-2" class="sphinx-tabs-panel" hidden="true" id="panel-8-8-2" name="8-2" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">is_even</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span>


<span class="n">numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>

<span class="n">even_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="n">is_even</span><span class="p">,</span> <span class="n">numbers</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">even_numbers</span><span class="p">)</span>
<span class="c1"># Output: [2, 4, 6]</span>
</pre></div>
</div>
</div></div>
</section>
</section>
<section id="know-your-collections">
<h4>Know your collections<a class="headerlink" href="#know-your-collections" title="Link to this heading"></a></h4>
<p>How to choose the right collection type:</p>
<ul class="simple">
<li><p>Ordered and modifiable: <code class="docutils literal notranslate"><span class="pre">list</span></code></p></li>
<li><p>Fixed and (rather) immutable: <code class="docutils literal notranslate"><span class="pre">tuple</span></code></p></li>
<li><p>Key-value pairs: <code class="docutils literal notranslate"><span class="pre">dict</span></code></p></li>
<li><p>Dictionary with default values: <code class="docutils literal notranslate"><span class="pre">defaultdict</span></code> from <a class="reference external" href="https://docs.python.org/3/library/collections.html#module-collections" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">collections</span></code></a></p></li>
<li><p>Members are unique, no duplicates: <code class="docutils literal notranslate"><span class="pre">set</span></code></p></li>
<li><p>Optimized operations at both ends: <code class="docutils literal notranslate"><span class="pre">deque</span></code> from <a class="reference external" href="https://docs.python.org/3/library/collections.html#module-collections" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">collections</span></code></a></p></li>
<li><p>Cyclical iteration: <code class="docutils literal notranslate"><span class="pre">cycle</span></code> from <a class="reference external" href="https://docs.python.org/3/library/itertools.html#module-itertools" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">itertools</span></code></a></p></li>
<li><p>Adding/removing elements in the middle: Create a linked list (e.g. using a dictionary or a dataclass)</p></li>
<li><p>Priority queue: <a class="reference external" href="https://docs.python.org/3/library/heapq.html#module-heapq" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">heapq</span></code></a> library</p></li>
<li><p>Search in sorted collections: <a class="reference external" href="https://docs.python.org/3/library/bisect.html#module-bisect" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">bisect</span></code></a> library</p></li>
</ul>
<p>What to avoid:</p>
<ul class="simple">
<li><p>Need to add/remove elements at the beginning or in the middle? Don’t use a list.</p></li>
<li><p>Need to make sure that elements are unique? Don’t use a list.</p></li>
</ul>
</section>
<section id="making-functions-more-ergonomic">
<h4>Making functions more ergonomic<a class="headerlink" href="#making-functions-more-ergonomic" title="Link to this heading"></a></h4>
<ul>
<li><p>Less error-prone API functions and fewer backwards-incompatible changes by enforcing keyword-only arguments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">send_message</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">recipient</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sending to </span><span class="si">{</span><span class="n">recipient</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Use dataclasses or named tuples or dictionaries instead of too many input or output arguments.</p></li>
<li><p>Docstrings instead of comments:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">send_message</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">message</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">recipient</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sends a message to a recipient.</span>

<span class="sd">    Parameters:</span>
<span class="sd">    - message (str): The content of the message.</span>
<span class="sd">    - recipient (str): The name of the person receiving the message.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sending to </span><span class="si">{</span><span class="n">recipient</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">message</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Consider using <code class="docutils literal notranslate"><span class="pre">DeprecationWarning</span></code> from the <a class="reference external" href="https://docs.python.org/3/library/warnings.html#module-warnings" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">warnings</span></code></a> module for deprecating functions or arguments.</p></li>
</ul>
</section>
<section id="id1">
<h4>Iterating<a class="headerlink" href="#id1" title="Link to this heading"></a></h4>
<ul>
<li><p>When working with large lists or large data sets, consider using generators or iterators instead of lists.
Discuss and compare these two:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">even_numbers1</span> <span class="o">=</span> <span class="p">[</span><span class="n">number</span> <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000000</span><span class="p">)</span> <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">even_numbers2</span> <span class="o">=</span> <span class="p">(</span><span class="n">number</span> <span class="k">for</span> <span class="n">number</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10000000</span><span class="p">)</span> <span class="k">if</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Beware of functions which iterate over the same collection multiple times.
With generators, you can iterate only once.</p></li>
<li><p>Know about <a class="reference external" href="https://docs.python.org/3/library/itertools.html#module-itertools" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">itertools</span></code></a> which provides a lot of functions for working with iterators.</p></li>
</ul>
</section>
<section id="dataclasses">
<h4>Dataclasses<a class="headerlink" href="#dataclasses" title="Link to this heading"></a></h4>
<p>Dataclasses are often a good alternative to regular classes:</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-9-9-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-9-9-0" name="9-0" role="tab" tabindex="0">Regular class</button><button aria-controls="panel-9-9-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-9-9-1" name="9-1" role="tab" tabindex="-1">Dataclass</button><button aria-controls="panel-9-9-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-9-9-2" name="9-2" role="tab" tabindex="-1">Named tuple</button></div><div aria-labelledby="tab-9-9-0" class="sphinx-tabs-panel" id="panel-9-9-0" name="9-0" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">Point</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;Point(x=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">, y=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s2">, z=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">Point</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">x</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">y</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">z</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-9-1" class="sphinx-tabs-panel" hidden="true" id="panel-9-9-1" name="9-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dataclass</span>

<span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Point</span><span class="p">:</span>
    <span class="n">x</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">y</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">z</span><span class="p">:</span> <span class="nb">float</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-9-2" class="sphinx-tabs-panel" hidden="true" id="panel-9-9-2" name="9-2" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">namedtuple</span>

<span class="n">Point</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s2">&quot;Point&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div></div>
</section>
<section id="use-relative-paths-and-pathlib">
<h4>Use relative paths and pathlib<a class="headerlink" href="#use-relative-paths-and-pathlib" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Scripts that read data from absolute paths are not portable and typically
break when shared with a colleague or support help desk or reused by the next
student/PhD student/postdoc.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#module-pathlib" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pathlib</span></code></a> is a modern and portable way to handle paths in Python.</p></li>
</ul>
</section>
<section id="project-structure">
<h4>Project structure<a class="headerlink" href="#project-structure" title="Link to this heading"></a></h4>
<ul>
<li><p>As your project grows from a simple script, you should consider organizing
your code into modules and packages.</p></li>
<li><p>Function too long? Consider splitting it into multiple functions.</p></li>
<li><p>File too long? Consider splitting it into multiple files.</p></li>
<li><p>Difficult to name a function or file? It might be doing too much or unrelated things.</p></li>
<li><p>If your script can be imported into other scripts, wrap your main function in
a <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">__name__</span> <span class="pre">==</span> <span class="pre">&quot;__main__&quot;:</span></code> block:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="o">...</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</li>
<li><p>Why this construct? You can try to either import or run the following script:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am being run as a script&quot;</span><span class="p">)</span>  <span class="c1"># importing will not run this part</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;I am being imported&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Try to have all code inside some function. This can make it easier to
understand, test, and reuse. It can also help Python to free up memory when
the function is done.</p></li>
</ul>
</section>
<section id="reading-and-writing-files">
<h4>Reading and writing files<a class="headerlink" href="#reading-and-writing-files" title="Link to this heading"></a></h4>
<ul>
<li><p>Good construct to know to read a file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;input.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Reading a huge data file? Read and process it in chunks or buffered or use a library which does it for you.</p></li>
<li><p>On supercomputers, avoid reading and writing thousands of small files.</p></li>
<li><p>For input files, consider using standard formats like CSV, YAML, or TOML - then you don’t need to write a parser.</p></li>
</ul>
</section>
<section id="use-subprocess-instead-of-os-system">
<h4>Use subprocess instead of os.system<a class="headerlink" href="#use-subprocess-instead-of-os-system" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Many things can go wrong when launching external processes from Python. The <a class="reference external" href="https://docs.python.org/3/library/subprocess.html#module-subprocess" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">subprocess</span></code></a> module is the recommended way to do this.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">os.system</span></code> is not portable and not secure enough.</p></li>
</ul>
</section>
<section id="parallelizing">
<h4>Parallelizing<a class="headerlink" href="#parallelizing" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Use one of the many libraries: <a class="reference external" href="https://docs.python.org/3/library/multiprocessing.html#module-multiprocessing" title="(in Python v3.13)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">multiprocessing</span></code></a>, <code class="xref py py-mod docutils literal notranslate"><span class="pre">mpi4py</span></code>, <a class="reference external" href="https://dask.org/">Dask</a>, <a class="reference external" href="https://parsl-project.org/">Parsl</a>, …</p></li>
<li><p>Identify independent tasks.</p></li>
<li><p>More often than not, you can convert an expensive loop into a command-line
tool and parallelize it using workflow management tools like
<a class="reference external" href="https://snakemake.github.io/">Snakemake</a>.</p></li>
</ul>
</section>
</section>
<span id="document-version-control"></span><section id="version-control-motivation">
<h3>Version control (motivation)<a class="headerlink" href="#version-control-motivation" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Browse <strong>commits</strong> and <strong>branches</strong> of a Git repository.</p></li>
<li><p>Remember that commits are like <strong>snapshots</strong> of the repository at a certain
point in time.</p></li>
<li><p>Know the difference between <strong>Git</strong> (something that tracks changes) and
<strong>GitHub/GitLab</strong> (a web platform to host Git repositories).</p></li>
</ul>
</div>
<section id="why-do-we-need-to-keep-track-of-versions">
<h4>Why do we need to keep track of versions?<a class="headerlink" href="#why-do-we-need-to-keep-track-of-versions" title="Link to this heading"></a></h4>
<p>Version control is an answer to the following questions (do you recognize some
of them?):</p>
<ul class="simple">
<li><p>“It broke … hopefully I have a working version somewhere?”</p></li>
<li><p>“Can you please send me the latest version?”</p></li>
<li><p>“Where is the latest version?”</p></li>
<li><p>“Which version are you using?”</p></li>
<li><p>“Which version have the authors used in the paper I am trying to reproduce?”</p></li>
<li><p>“Found a bug! Since when was it there?”</p></li>
<li><p>“I am sure it used to work. When did it change?”</p></li>
<li><p>“My laptop is gone. Is my thesis now gone?”</p></li>
</ul>
</section>
<section id="demonstration">
<h4>Demonstration<a class="headerlink" href="#demonstration" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Example repository: <a class="reference external" href="https://github.com/workshop-material/planets">https://github.com/workshop-material/planets</a></p></li>
<li><p>Commits are like <strong>snapshots</strong> and if we break something we can go back to a
previous snapshot.</p></li>
<li><p>Commits carry <strong>metadata</strong> about changes: author, date, commit message, and
a checksum.</p></li>
<li><p><strong>Branches</strong> are like parallel universes where you can experiment with
changes without affecting the default branch:
<a class="reference external" href="https://github.com/workshop-material/planets/network">https://github.com/workshop-material/planets/network</a>
(“Insights” -&gt; “Network”)</p></li>
<li><p>With version control we can <strong>annotate code</strong>
(<a class="reference external" href="https://github.com/workshop-material/planets/blame/main/simulate.py">example</a>).</p></li>
<li><p><strong>Collaboration</strong>: We can fork (make a copy on GitHub), clone (make a copy
to our computer), review, compare, share, and discuss.</p></li>
<li><p><strong>Code review</strong>: Others can suggest changes using pull requests or merge
requests. These can be reviewed and discussed before they are merged.
Conceptually, they are similar to “suggesting changes” in Google Docs.</p></li>
</ul>
</section>
<section id="features-roll-back-branching-merging-collaboration">
<h4>Features: roll-back, branching, merging, collaboration<a class="headerlink" href="#features-roll-back-branching-merging-collaboration" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Roll-back</strong>: you can always go back to a previous version and compare</p></li>
<li><p><strong>Branching and merging</strong>:</p>
<ul>
<li><p>Work on different ideas at the same time</p></li>
<li><p>You can experiment with an idea and discard it if it turns out to be a bad idea</p></li>
<li><p>Different people can work on the same code/project without interfering</p></li>
</ul>
</li>
</ul>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/gophers.png"><img alt="Branching explained with a gopher" src="_images/gophers.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Image created using <a class="reference external" href="https://gopherize.me/">https://gopherize.me/</a>
(<a class="reference external" href="https://twitter.com/jay_gee/status/703360688618536960">inspiration</a>).</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<ul class="simple">
<li><p><strong>Collaboration</strong>: review, compare, share, discuss</p></li>
<li><p><a class="reference external" href="https://github.com/workshop-material/planets/network">Example network graph</a></p></li>
</ul>
</section>
<section id="talking-about-code">
<h4>Talking about code<a class="headerlink" href="#talking-about-code" title="Link to this heading"></a></h4>
<p>Which of these two is more practical?</p>
<ol class="arabic simple">
<li><p>“Clone the code, go to the file ‘simulate.py’, and search for ‘force_between_planets’.
Oh! But make sure you use the version from September 2024.”</p></li>
<li><p>Or I can send you a permalink: <a class="reference external" href="https://github.com/workshop-material/planets/blob/1343ac0/simulate.py#L31C5-L39">https://github.com/workshop-material/planets/blob/1343ac0/simulate.py#L31C5-L39</a></p></li>
</ol>
</section>
<section id="what-we-typically-like-to-snapshot">
<h4>What we typically like to snapshot<a class="headerlink" href="#what-we-typically-like-to-snapshot" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Software (this is how it started but Git/GitHub can track a lot more)</p></li>
<li><p>Scripts</p></li>
<li><p>Documents (plain text files much better suitable than Word documents)</p></li>
<li><p>Manuscripts (Git is great for collaborating/sharing LaTeX or <a class="reference external" href="https://quarto.org/">Quarto</a> manuscripts)</p></li>
<li><p>Configuration files</p></li>
<li><p>Website sources</p></li>
<li><p>Data</p></li>
</ul>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<p>In this example somebody tried to keep track of versions without a version
control system tool like Git.  Discuss the following directory listing. What
possible problems do you anticipate with this kind of “version control”:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>myproject-2019.zip
myproject-2020-february.zip
myproject-2021-august.zip
myproject-2023-09-19-working.zip
myproject-2023-09-21.zip
myproject-2023-09-21-test.zip
myproject-2023-09-21-myversion.zip
myproject-2023-09-21-newfeature.zip
...
(100 more files like these)
</pre></div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<ul class="simple">
<li><p>Giving a version to a collaborator and merging changes later with own
changes sounds like lots of work.</p></li>
<li><p>What if you discover a bug and want to know since when the bug existed?</p></li>
</ul>
</div>
</div>
</section>
<section id="where-to-learn-more">
<h4>Where to learn more<a class="headerlink" href="#where-to-learn-more" title="Link to this heading"></a></h4>
<p><a class="reference external" href="https://coderefinery.org/lessons/">CodeRefinery lessons</a> with <strong>focus on collaboration</strong> and <strong>not only for the command line</strong>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://coderefinery.github.io/git-intro/">Introduction to version control</a> (day 1-2):
<strong>Why we want to track versions and how to go back in time to a working version.</strong>
This lesson brings you from zero to using Git and GitHub for own projects.</p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/git-collaborative/">Collaborative distributed version control</a> (day 3):
This lesson builds on “Introduction to version control” and we apply branching and learn about pull requests
(merge requests), forks, and collaboration using Git and GitHub.</p></li>
</ul>
</section>
</section>
<span id="document-dependencies"></span><section id="reproducible-environments-and-dependencies">
<h3>Reproducible environments and dependencies<a class="headerlink" href="#reproducible-environments-and-dependencies" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>There are not many codes that have no dependencies.
How should we <strong>deal with dependencies</strong>?</p></li>
<li><p>We will focus on installing and managing dependencies in Python when using packages from PyPI and Conda.</p></li>
<li><p>We will not discuss how to distribute your code as a package.</p></li>
</ul>
</div>
<p>[This episode borrows from <a class="reference external" href="https://coderefinery.github.io/reproducible-python/reusable/">https://coderefinery.github.io/reproducible-python/reusable/</a>
and <a class="reference external" href="https://aaltoscicomp.github.io/python-for-scicomp/dependencies/">https://aaltoscicomp.github.io/python-for-scicomp/dependencies/</a>]</p>
<p>Essential XKCD comics:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://xkcd.com/2347/">xkcd - dependency</a></p></li>
<li><p><a class="reference external" href="https://xkcd.com/1987/">xkcd - superfund</a></p></li>
</ul>
<section id="how-to-avoid-it-works-on-my-machine">
<h4>How to avoid: “It works on my machine 🤷”<a class="headerlink" href="#how-to-avoid-it-works-on-my-machine" title="Link to this heading"></a></h4>
<p>Use a <strong>standard way</strong> to list dependencies in your project:</p>
<ul class="simple">
<li><p>Python: <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> or <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code></p></li>
<li><p>R: <code class="docutils literal notranslate"><span class="pre">DESCRIPTION</span></code> or <code class="docutils literal notranslate"><span class="pre">renv.lock</span></code></p></li>
<li><p>Rust: <code class="docutils literal notranslate"><span class="pre">Cargo.lock</span></code></p></li>
<li><p>Julia: <code class="docutils literal notranslate"><span class="pre">Project.toml</span></code></p></li>
<li><p>C/C++/Fortran: <code class="docutils literal notranslate"><span class="pre">CMakeLists.txt</span></code> or <code class="docutils literal notranslate"><span class="pre">Makefile</span></code> or <code class="docutils literal notranslate"><span class="pre">spack.yaml</span></code> or the module
system on clusters or containers</p></li>
<li><p>Other languages: …</p></li>
</ul>
</section>
<section id="two-ecosystems-pypi-the-python-package-index-and-conda">
<h4>Two ecosystems: PyPI (The Python Package Index) and Conda<a class="headerlink" href="#two-ecosystems-pypi-the-python-package-index-and-conda" title="Link to this heading"></a></h4>
<div class="admonition-pypi admonition">
<p class="admonition-title">PyPI</p>
<ul class="simple">
<li><p><strong>Installation tool:</strong> <code class="docutils literal notranslate"><span class="pre">pip</span></code> or <code class="docutils literal notranslate"><span class="pre">uv</span></code> or similar</p></li>
<li><p>Traditionally used for Python-only packages or
for Python interfaces to external libraries. There are also packages
that have bundled external libraries (such as numpy).</p></li>
<li><p><strong>Pros:</strong></p>
<ul>
<li><p>Easy to use</p></li>
<li><p>Package creation is easy</p></li>
</ul>
</li>
<li><p><strong>Cons:</strong></p>
<ul>
<li><p>Installing packages that need external libraries can be complicated</p></li>
</ul>
</li>
</ul>
</div>
<div class="admonition-conda admonition">
<p class="admonition-title">Conda</p>
<ul class="simple">
<li><p><strong>Installation tool:</strong> <code class="docutils literal notranslate"><span class="pre">conda</span></code> or <code class="docutils literal notranslate"><span class="pre">mamba</span></code> or similar</p></li>
<li><p>Aims to be a more general package distribution tool
and it tries to provide not only the Python packages, but also libraries
and tools needed by the Python packages.</p></li>
<li><p><strong>Pros:</strong></p>
<ul>
<li><p>Quite easy to use</p></li>
<li><p>Easier to manage packages that need external libraries</p></li>
<li><p>Not only for Python</p></li>
</ul>
</li>
<li><p><strong>Cons:</strong></p>
<ul>
<li><p>Package creation is harder</p></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="conda-ecosystem-explained">
<h4>Conda ecosystem explained<a class="headerlink" href="#conda-ecosystem-explained" title="Link to this heading"></a></h4>
<ul>
<li><p><a class="reference external" href="https://www.anaconda.com">Anaconda</a> is a distribution of conda packages
made by Anaconda Inc. When using Anaconda remember to check that your
situation abides with their licensing terms (see below).</p></li>
<li><p>Anaconda has recently changed its <strong>licensing terms</strong>, which affects its
use in a professional setting. This caused uproar among academia
and Anaconda modified their position in
<a class="reference external" href="https://www.anaconda.com/blog/update-on-anacondas-terms-of-service-for-academia-and-research">this article</a>.</p>
<p>Main points of the article are:</p>
<ul class="simple">
<li><p>conda (installation tool) and community channels (e.g. conda-forge)
are free to use.</p></li>
<li><p>Anaconda repository and <strong>Anaconda’s channels in the community repository</strong>
are free for universities and companies with fewer than 200 employees.
Non-university research institutions and national laboratories need
licenses.</p></li>
<li><p>Miniconda is free, when it does not download Anaconda’s packages.</p></li>
<li><p>Miniforge is not related to Anaconda, so it is free.</p></li>
</ul>
<p>For ease of use on sharing environment files, we recommend using
Miniforge to create the environments and using conda-forge as the main
channel that provides software.</p>
</li>
<li><p>Major repositories/channels:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://repo.anaconda.com">Anaconda Repository</a>
houses Anaconda’s own proprietary software channels.</p></li>
<li><p>Anaconda’s proprietary channels: <code class="docutils literal notranslate"><span class="pre">main</span></code>, <code class="docutils literal notranslate"><span class="pre">r</span></code>, <code class="docutils literal notranslate"><span class="pre">msys2</span></code> and <code class="docutils literal notranslate"><span class="pre">anaconda</span></code>.
These are sometimes called <code class="docutils literal notranslate"><span class="pre">defaults</span></code>.</p></li>
<li><p><a class="reference external" href="https://conda-forge.org">conda-forge</a> is the largest open source
community channel. It has over 28k packages that include open-source
versions of packages in Anaconda’s channels.</p></li>
</ul>
</li>
</ul>
</section>
<section id="tools-and-distributions-for-dependency-management-in-python">
<h4>Tools and distributions for dependency management in Python<a class="headerlink" href="#tools-and-distributions-for-dependency-management-in-python" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://python-poetry.org">Poetry</a>: Dependency management and packaging.</p></li>
<li><p><a class="reference external" href="https://pipenv.pypa.io">Pipenv</a>: Dependency management, alternative to Poetry.</p></li>
<li><p><a class="reference external" href="https://github.com/pyenv/pyenv">pyenv</a>: If you need different Python versions for different projects.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/venv.html">virtualenv</a>: Tool to create isolated Python environments for PyPI packages.</p></li>
<li><p><a class="reference external" href="https://github.com/thoth-station/micropipenv">micropipenv</a>: Lightweight tool to “rule them all”.</p></li>
<li><p><a class="reference external" href="https://docs.conda.io">Conda</a>: Package manager for Python and other languages maintained by Anaconda Inc.</p></li>
<li><p><a class="reference external" href="https://docs.anaconda.com/miniconda/">Miniconda</a>: A “miniature” version of conda, maintained by Anaconda Inc. By default uses
Anaconda’s channels. Check licensing terms when using these packages.</p></li>
<li><p><a class="reference external" href="https://mamba.readthedocs.io">Mamba</a>: A drop in replacement for conda.
It used be much faster than conda due to better
dependency solver but nowadays conda
<a class="reference external" href="https://conda.org/blog/2023-11-06-conda-23-10-0-release/">also uses the same solver</a>.
It still has some UI improvements.</p></li>
<li><p><a class="reference external" href="https://mamba.readthedocs.io/en/latest/user_guide/micromamba.html">Micromamba</a>: Tiny version of the Mamba package manager.</p></li>
<li><p><a class="reference external" href="https://github.com/conda-forge/miniforge">Miniforge</a>: Open-source Miniconda alternative with
conda-forge as the default channel and optionally mamba as the default installer.</p></li>
<li><p><a class="reference external" href="https://pixi.sh">Pixi</a>: Modern, super fast tool which can manage conda environments.</p></li>
<li><p><a class="reference external" href="https://docs.astral.sh/uv/">uv</a>: Modern, super fast replacement for pip,
poetry, pyenv, and virtualenv. You can also switch between Python versions.</p></li>
</ul>
</section>
<section id="best-practice-install-dependencies-into-isolated-environments">
<h4>Best practice: Install dependencies into isolated environments<a class="headerlink" href="#best-practice-install-dependencies-into-isolated-environments" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>For each project, create a <strong>separate environment</strong>.</p></li>
<li><p>Don’t install dependencies globally for all projects. Sooner or later, different projects will have conflicting dependencies.</p></li>
<li><p>Install them <strong>from a file</strong> which documents them at the same time
Install dependencies by first recording them in <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> or
<code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> and install using these files, then you have a trace
(we will practice this later below).</p></li>
</ul>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<p>If somebody asks you what dependencies you have in your project, you should be
able to answer this question <strong>with a file</strong>.</p>
<p>In Python, the two most common ways to do this are:</p>
<ul class="simple">
<li><p><strong>requirements.txt</strong> (for pip and virtual environments)</p></li>
<li><p><strong>environment.yml</strong> (for conda and similar)</p></li>
</ul>
<p>You can export (“freeze”) the dependencies from your current environment into these files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># inside a conda environment</span>
$<span class="w"> </span>conda<span class="w"> </span>env<span class="w"> </span><span class="nb">export</span><span class="w"> </span>--from-history<span class="w"> </span>&gt;<span class="w"> </span>environment.yml

<span class="c1"># inside a virtual environment</span>
$<span class="w"> </span>pip<span class="w"> </span>freeze<span class="w"> </span>&gt;<span class="w"> </span>requirements.txt
</pre></div>
</div>
</div>
</section>
<section id="how-to-communicate-the-dependencies-as-part-of-a-report-thesis-publication">
<h4>How to communicate the dependencies as part of a report/thesis/publication<a class="headerlink" href="#how-to-communicate-the-dependencies-as-part-of-a-report-thesis-publication" title="Link to this heading"></a></h4>
<p>Each notebook or script or project which depends on libraries should come with
either a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> or a <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code>, unless you are creating
and distributing this project as Python package.</p>
<ul class="simple">
<li><p>Attach a <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> or a <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> to your thesis.</p></li>
<li><p>Even better: Put <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> or a <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> in your Git repository along your code.</p></li>
<li><p>Even better: Also <a class="reference external" href="https://mybinder.org/">binderize</a> your analysis pipeline.</p></li>
</ul>
</section>
<section id="containers">
<h4>Containers<a class="headerlink" href="#containers" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>A container is like an <strong>operating system inside a file</strong>.</p></li>
<li><p>“Building a container”: Container definition file (recipe) -&gt; Container image</p></li>
<li><p>This can be used with <a class="reference external" href="https://apptainer.org/">Apptainer</a>/
<a class="reference external" href="https://sylabs.io/singularity/">SingularityCE</a>.</p></li>
</ul>
<p>Containers offer the following advantages:</p>
<ul class="simple">
<li><p><strong>Reproducibility</strong>: The same software environment can be recreated on
different computers. They force you to know and <strong>document all your dependencies</strong>.</p></li>
<li><p><strong>Portability</strong>: The same software environment can be run on different computers.</p></li>
<li><p><strong>Isolation</strong>: The software environment is isolated from the host system.</p></li>
<li><p>“<strong>Time travel</strong>”:</p>
<ul>
<li><p>You can run old/unmaintained software on new systems.</p></li>
<li><p>Code that needs new dependencies which are not available on old systems can
still be run on old systems.</p></li>
</ul>
</li>
</ul>
</section>
<section id="how-to-install-dependencies-into-environments">
<h4>How to install dependencies into environments<a class="headerlink" href="#how-to-install-dependencies-into-environments" title="Link to this heading"></a></h4>
<p>Now we understand a bit better why and how we installed dependencies
for this course in the <a class="reference internal" href="#document-installation"><span class="doc">Software install instructions</span></a>.</p>
<p>We have used <strong>Miniforge</strong> and the long command we have used was:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mamba<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>course<span class="w"> </span>-f<span class="w"> </span>https://raw.githubusercontent.com/coderefinery/python-progression/main/software/environment.yml
</pre></div>
</div>
<p>This command did two things:</p>
<ul class="simple">
<li><p>Create a new environment with name “course” (specified by <code class="docutils literal notranslate"><span class="pre">-n</span></code>).</p></li>
<li><p>Installed all dependencies listed in the <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> file (specified by
<code class="docutils literal notranslate"><span class="pre">-f</span></code>), which we fetched directly from the web.
<a class="reference external" href="https://github.com/coderefinery/python-progression/blob/main/software/environment.yml">Here</a>
you can browse it.</p></li>
</ul>
<p>For your own projects:</p>
<ol class="arabic simple">
<li><p>Start by writing an <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> of <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file. They look like this:</p></li>
</ol>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">environment.yml</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">requirements.txt</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">course</span>
<span class="nt">channels</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">conda-forge</span>
<span class="nt">dependencies</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">python &lt;= 3.12</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">jupyterlab</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">altair-all</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vega_datasets</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">numpy</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pytest</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scalene</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ruff</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">icecream</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myst-parser</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx-rtd-theme</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx-autoapi</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sphinx-autobuild</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupyterlab</span>
<span class="n">altair</span>
<span class="n">vega_datasets</span>
<span class="n">pandas</span>
<span class="n">numpy</span>
<span class="n">pytest</span>
<span class="n">scalene</span>
<span class="n">ruff</span>
<span class="n">icecream</span>
<span class="n">myst</span><span class="o">-</span><span class="n">parser</span>
<span class="n">sphinx</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">rtd</span><span class="o">-</span><span class="n">theme</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">autoapi</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">autobuild</span>
</pre></div>
</div>
</div></div>
<ol class="arabic simple" start="2">
<li><p>Then set up an isolated environment and install the dependencies from the file into it:</p></li>
</ol>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-TWluaWZvcmdl" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-1-TWluaWZvcmdl" name="TWluaWZvcmdl" role="tab" tabindex="0">Miniforge</button><button aria-controls="panel-1-UGl4aQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-UGl4aQ==" name="UGl4aQ==" role="tab" tabindex="-1">Pixi</button><button aria-controls="panel-1-VmlydHVhbCBlbnZpcm9ubWVudA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-VmlydHVhbCBlbnZpcm9ubWVudA==" name="VmlydHVhbCBlbnZpcm9ubWVudA==" role="tab" tabindex="-1">Virtual environment</button><button aria-controls="panel-1-dXY=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-1-dXY=" name="dXY=" role="tab" tabindex="-1">uv</button></div><div aria-labelledby="tab-1-TWluaWZvcmdl" class="sphinx-tabs-panel group-tab" id="panel-1-TWluaWZvcmdl" name="TWluaWZvcmdl" role="tabpanel" tabindex="0"><ul>
<li><p>Create a new environment with name “myenv” from <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>myenv<span class="w"> </span>-f<span class="w"> </span>environment.yml
</pre></div>
</div>
<p>Or equivalently:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mamba<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>myenv<span class="w"> </span>-f<span class="w"> </span>environment.yml
</pre></div>
</div>
</li>
<li><p>Activate the environment:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda<span class="w"> </span>activate<span class="w"> </span>myenv
</pre></div>
</div>
</li>
<li><p>Run your code inside the activated virtual environment.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>example.py
</pre></div>
</div>
</li>
</ul>
</div><div aria-labelledby="tab-1-UGl4aQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-UGl4aQ==" name="UGl4aQ==" role="tabpanel" tabindex="0"><ul>
<li><p>Create <code class="docutils literal notranslate"><span class="pre">pixi.toml</span></code> from <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pixi<span class="w"> </span>init<span class="w"> </span>--import<span class="w"> </span>environment.yml
</pre></div>
</div>
</li>
<li><p>Run your code inside the environment:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pixi<span class="w"> </span>run<span class="w"> </span>python<span class="w"> </span>example.py
</pre></div>
</div>
</li>
</ul>
</div><div aria-labelledby="tab-1-VmlydHVhbCBlbnZpcm9ubWVudA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-VmlydHVhbCBlbnZpcm9ubWVudA==" name="VmlydHVhbCBlbnZpcm9ubWVudA==" role="tabpanel" tabindex="0"><ul>
<li><p>Create a virtual environment by running (the second argument is the name
of the environment and you can change it):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>venv
</pre></div>
</div>
</li>
<li><p>Activate the virtual environment (how precisely depends on your operating
system and shell).</p></li>
<li><p>Install the dependencies:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
</li>
<li><p>Run your code inside the activated virtual environment.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>python<span class="w"> </span>example.py
</pre></div>
</div>
</li>
</ul>
</div><div aria-labelledby="tab-1-dXY=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-1-dXY=" name="dXY=" role="tabpanel" tabindex="0"><ul>
<li><p>Create a virtual environment by running (the second argument is the name
of the environment and you can change it):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>uv<span class="w"> </span>venv<span class="w"> </span>venv
</pre></div>
</div>
</li>
<li><p>Activate the virtual environment (how precisely depends on your operating
system and shell).</p></li>
<li><p>Install the dependencies:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>uv<span class="w"> </span>pip<span class="w"> </span>sync<span class="w"> </span>requirements.txt
</pre></div>
</div>
</li>
<li><p>Run your code inside the virtual environment.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>uv<span class="w"> </span>run<span class="w"> </span>python<span class="w"> </span>example.py
</pre></div>
</div>
</li>
</ul>
</div></div>
</section>
<section id="updating-environments">
<h4>Updating environments<a class="headerlink" href="#updating-environments" title="Link to this heading"></a></h4>
<p>What if you forgot a dependency? Or during the development of your project
you realize that you need a new dependency? Or you don’t need some dependency anymore?</p>
<ol class="arabic simple">
<li><p>Modify the <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> or <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file.</p></li>
<li><p>Either remove your environment and create a new one, or update the existing one:</p></li>
</ol>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-TWluaWZvcmdl" aria-selected="true" class="sphinx-tabs-tab group-tab" id="tab-2-TWluaWZvcmdl" name="TWluaWZvcmdl" role="tab" tabindex="0">Miniforge</button><button aria-controls="panel-2-UGl4aQ==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-UGl4aQ==" name="UGl4aQ==" role="tab" tabindex="-1">Pixi</button><button aria-controls="panel-2-VmlydHVhbCBlbnZpcm9ubWVudA==" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-VmlydHVhbCBlbnZpcm9ubWVudA==" name="VmlydHVhbCBlbnZpcm9ubWVudA==" role="tab" tabindex="-1">Virtual environment</button><button aria-controls="panel-2-dXY=" aria-selected="false" class="sphinx-tabs-tab group-tab" id="tab-2-dXY=" name="dXY=" role="tab" tabindex="-1">uv</button></div><div aria-labelledby="tab-2-TWluaWZvcmdl" class="sphinx-tabs-panel group-tab" id="panel-2-TWluaWZvcmdl" name="TWluaWZvcmdl" role="tabpanel" tabindex="0"><ul>
<li><p>Update the environment by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>conda<span class="w"> </span>env<span class="w"> </span>update<span class="w"> </span>--file<span class="w"> </span>environment.yml
</pre></div>
</div>
</li>
<li><p>Or equivalently:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mamba<span class="w"> </span>env<span class="w"> </span>update<span class="w"> </span>--file<span class="w"> </span>environment.yml
</pre></div>
</div>
</li>
</ul>
</div><div aria-labelledby="tab-2-UGl4aQ==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-UGl4aQ==" name="UGl4aQ==" role="tabpanel" tabindex="0"><ul>
<li><p>Remove <code class="docutils literal notranslate"><span class="pre">pixi.toml</span></code>.</p></li>
<li><p>Then update it from the updated <code class="docutils literal notranslate"><span class="pre">environment.yml</span></code> by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pixi<span class="w"> </span>init<span class="w"> </span>--import<span class="w"> </span>environment.yml
</pre></div>
</div>
</li>
</ul>
</div><div aria-labelledby="tab-2-VmlydHVhbCBlbnZpcm9ubWVudA==" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-VmlydHVhbCBlbnZpcm9ubWVudA==" name="VmlydHVhbCBlbnZpcm9ubWVudA==" role="tabpanel" tabindex="0"><ul>
<li><p>Activate the virtual environment.</p></li>
<li><p>Update the environment by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
</li>
</ul>
</div><div aria-labelledby="tab-2-dXY=" class="sphinx-tabs-panel group-tab" hidden="true" id="panel-2-dXY=" name="dXY=" role="tabpanel" tabindex="0"><ul>
<li><p>Activate the virtual environment.</p></li>
<li><p>Update the environment by running:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>uv<span class="w"> </span>pip<span class="w"> </span>sync<span class="w"> </span>requirements.txt
</pre></div>
</div>
</li>
</ul>
</div></div>
</section>
<section id="pinning-package-versions">
<h4>Pinning package versions<a class="headerlink" href="#pinning-package-versions" title="Link to this heading"></a></h4>
<p>Let us look at the
<a class="reference external" href="https://github.com/coderefinery/python-progression/blob/main/software/environment.yml">environment.yml</a>
which we used to set up the environment for this progression course.
Dependencies are listed without version numbers. Should we <strong>pin the
versions</strong>?</p>
<ul class="simple">
<li><p>Both <code class="docutils literal notranslate"><span class="pre">pip</span></code> and <code class="docutils literal notranslate"><span class="pre">conda</span></code> ecosystems and all the tools that we have
mentioned support pinning versions.</p></li>
<li><p>It is possible to define a range of versions instead of precise versions.</p></li>
<li><p>While your project is still in progress, I often use latest versions and do not pin them.</p></li>
<li><p>When publishing the script or notebook, it is a good idea to pin the versions
to ensure that the code can be run in the future.</p></li>
<li><p>Remember that at some point in time you will face a situation where
newer versions of the dependencies are no longer compatible with your
software. At this point you’ll have to update your software to use the newer
versions or to lock it into a place in time.</p></li>
</ul>
</section>
<section id="managing-dependencies-on-a-supercomputer">
<h4>Managing dependencies on a supercomputer<a class="headerlink" href="#managing-dependencies-on-a-supercomputer" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Additional challenges:</p>
<ul>
<li><p>Storage quotas: <strong>Do not install dependencies in your home directory</strong>. A conda environment can easily contain 100k files.</p></li>
<li><p>Network file systems struggle with many small files. Conda environments often contain many small files.</p></li>
</ul>
</li>
<li><p>Possible solutions:</p>
<ul>
<li><p>Try <a class="reference external" href="https://pixi.sh/">Pixi</a> (modern take on managing Conda environments) and
<a class="reference external" href="https://docs.astral.sh/uv/">uv</a> (modern take on managing virtual
environments). Blog post: <a class="reference external" href="https://research-software.uit.no/blog/2025-pixi-and-uv/">Using Pixi and uv on a supercomputer</a></p></li>
<li><p>Install your environment on the fly into a scratch directory on local disk (<strong>not</strong> the network file system).</p></li>
<li><p>Install your environment on the fly into a RAM disk/drive.</p></li>
<li><p>Containerize your environment into a container image.</p></li>
</ul>
</li>
</ul>
<hr class="docutils" />
<div class="admonition-keypoints keypoints admonition" id="keypoints-1">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Being able to communicate your dependencies is not only nice for others, but
also for your future self or the next PhD student or post-doc.</p></li>
<li><p>If you ask somebody to help you with your code, they will ask you for the
dependencies.</p></li>
</ul>
</div>
</section>
</section>
<span id="document-documentation"></span><section id="where-to-start-with-documentation">
<h3>Where to start with documentation<a class="headerlink" href="#where-to-start-with-documentation" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Discuss what makes good documentation.</p></li>
<li><p>Improve the README of your project or our example project.</p></li>
<li><p>Explore Sphinx which is a popular tool to build documentation websites.</p></li>
<li><p>Learn how to leverage GitHub Actions and GitHub Pages to build and deploy documentation.</p></li>
</ul>
</div>
<section id="why-to-your-future-self">
<h4>Why? 💗✉️ to your future self<a class="headerlink" href="#why-to-your-future-self" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>You will probably use your code in the future and may forget details.</p></li>
<li><p>You may want others to use your code or contribute
(almost impossible without documentation).</p></li>
</ul>
</section>
<section id="in-code-documentation">
<h4>In-code documentation<a class="headerlink" href="#in-code-documentation" title="Link to this heading"></a></h4>
<p>Not very useful (more commentary than comment):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># now we check if temperature is below -50</span>
<span class="k">if</span> <span class="n">temperature</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">50</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: temperature is too low&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>More useful (explaining <strong>why</strong>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we regard temperatures below -50 degrees as measurement errors</span>
<span class="k">if</span> <span class="n">temperature</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">50</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ERROR: temperature is too low&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Keeping zombie code “just in case” (rather use version control):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># do not run this code!</span>
<span class="c1"># if temperature &gt; 0:</span>
<span class="c1">#     print(&quot;It is warm&quot;)</span>
</pre></div>
</div>
<p>Emulating version control:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># John Doe: threshold changed from 0 to 15 on August 5, 2013</span>
<span class="k">if</span> <span class="n">temperature</span> <span class="o">&gt;</span> <span class="mi">15</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;It is warm&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="many-languages-allow-docstrings">
<h4>Many languages allow “docstrings”<a class="headerlink" href="#many-languages-allow-docstrings" title="Link to this heading"></a></h4>
<p>Example (Python):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">kelvin_to_celsius</span><span class="p">(</span><span class="n">temp_k</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Converts temperature in Kelvin to Celsius.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    temp_k : float</span>
<span class="sd">        temperature in Kelvin</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    temp_c : float</span>
<span class="sd">        temperature in Celsius</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="n">temp_k</span> <span class="o">&gt;=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;ERROR: negative T_K&quot;</span>

    <span class="n">temp_c</span> <span class="o">=</span> <span class="n">temp_k</span> <span class="o">-</span> <span class="mf">273.15</span>

    <span class="k">return</span> <span class="n">temp_c</span>
</pre></div>
</div>
<div class="admonition-keypoints keypoints admonition" id="keypoints-0">
<p class="admonition-title">Keypoints</p>
<ul class="simple">
<li><p>Documentation which is only in the source code is not enough.</p></li>
<li><p>Often a README is enough.</p></li>
<li><p>Documentation needs to be kept
<strong>in the same Git repository</strong> as the code since we want it to evolve with
the code.</p></li>
</ul>
</div>
</section>
<section id="often-a-readme-is-enough-checklist">
<h4>Often a README is enough - checklist<a class="headerlink" href="#often-a-readme-is-enough-checklist" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><strong>Purpose</strong></p></li>
<li><p>Requirements</p></li>
<li><p>Installation instructions</p></li>
<li><p><strong>Copy-paste-able example to get started</strong></p></li>
<li><p>Tutorials covering key functionality</p></li>
<li><p>Reference documentation (e.g. API) covering all functionality</p></li>
<li><p>Authors and <strong>recommended citation</strong></p></li>
<li><p>License</p></li>
<li><p>Contribution guide</p></li>
</ul>
<p>See also the
<a class="reference external" href="https://joss.readthedocs.io/en/latest/review_checklist.html">JOSS review checklist</a>.</p>
</section>
<section id="diataxis">
<h4>Diátaxis<a class="headerlink" href="#diataxis" title="Link to this heading"></a></h4>
<p>Diátaxis is a systematic approach to technical documentation authoring.</p>
<ul class="simple">
<li><p>Overview: <a class="reference external" href="https://diataxis.fr/">https://diataxis.fr/</a></p></li>
<li><p>How to use Diátaxis <strong>as a guide</strong> to work: <a class="reference external" href="https://diataxis.fr/how-to-use-diataxis/">https://diataxis.fr/how-to-use-diataxis/</a></p></li>
</ul>
</section>
<section id="what-if-you-need-more-than-a-readme">
<h4>What if you need more than a README?<a class="headerlink" href="#what-if-you-need-more-than-a-readme" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Write documentation in
<a class="reference external" href="https://en.wikipedia.org/wiki/Markdown">Markdown (.md)</a>
or
<a class="reference external" href="https://en.wikipedia.org/wiki/ReStructuredText">reStructuredText (.rst)</a>
or
<a class="reference external" href="https://rmarkdown.rstudio.com/">R Markdown (.Rmd)</a></p></li>
<li><p>In the <strong>same repository</strong> as the code -&gt; version control and <strong>reproducibility</strong></p></li>
<li><p>Use one of many tools to build HTML out of md/rst/Rmd:
<a class="reference external" href="https://sphinx-doc.org">Sphinx</a>,
<a class="reference external" href="https://www.mkdocs.org/">MkDocs</a>,
<a class="reference external" href="https://www.getzola.org/">Zola</a>, <a class="reference external" href="https://jekyllrb.com/">Jekyll</a>,
<a class="reference external" href="https://gohugo.io/">Hugo</a>, RStudio, <a class="reference external" href="https://yihui.org/knitr/">knitr</a>,
<a class="reference external" href="https://bookdown.org/">bookdown</a>,
<a class="reference external" href="https://bookdown.org/yihui/blogdown/">blogdown</a>, …</p></li>
<li><p>Deploy the generated HTML to <a class="reference external" href="https://pages.github.com/">GitHub Pages</a> or
<a class="reference external" href="https://docs.gitlab.com/ee/user/project/pages/">GitLab Pages</a></p></li>
</ul>
</section>
<section id="setting-up-a-sphinx-documentation">
<h4>Setting up a Sphinx documentation<a class="headerlink" href="#setting-up-a-sphinx-documentation" title="Link to this heading"></a></h4>
<div class="admonition-preparation prerequisites admonition" id="prerequisites-0">
<p class="admonition-title">Preparation</p>
<p>In this episode we will use the following 5 packages which we installed
previously as part of the <a class="reference internal" href="#document-installation"><span class="doc">Software install instructions</span></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myst</span><span class="o">-</span><span class="n">parser</span>
<span class="n">sphinx</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">rtd</span><span class="o">-</span><span class="n">theme</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">autoapi</span>
<span class="n">sphinx</span><span class="o">-</span><span class="n">autobuild</span>
</pre></div>
</div>
</div>
<p>There are at least two ways to get started with Sphinx:</p>
<ol class="arabic simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">sphinx-quickstart</span></code> to create a new Sphinx project.</p></li>
<li><p><strong>This is what we will do instead</strong>: Create three files (<code class="docutils literal notranslate"><span class="pre">doc/conf.py</span></code>, <code class="docutils literal notranslate"><span class="pre">doc/index.md</span></code>, and <code class="docutils literal notranslate"><span class="pre">doc/about.md</span></code>)
as starting point and improve from there.</p></li>
</ol>
<div class="admonition-exercise-set-up-a-sphinx-documentation exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Set up a Sphinx documentation</p>
<ol class="arabic">
<li><p>Create the following three files in your project:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>your-project/
├── doc/
│   ├── conf.py
│   ├── index.md
│   └── about.md
└── ...
</pre></div>
</div>
<p>This is <code class="docutils literal notranslate"><span class="pre">conf.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">project</span> <span class="o">=</span> <span class="s2">&quot;your-project&quot;</span>
<span class="n">copyright</span> <span class="o">=</span> <span class="s2">&quot;2025, Authors&quot;</span>
<span class="n">author</span> <span class="o">=</span> <span class="s2">&quot;Authors&quot;</span>
<span class="n">release</span> <span class="o">=</span> <span class="s2">&quot;0.1&quot;</span>

<span class="n">exclude_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_build&quot;</span><span class="p">,</span> <span class="s2">&quot;Thumbs.db&quot;</span><span class="p">,</span> <span class="s2">&quot;.DS_Store&quot;</span><span class="p">]</span>

<span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;myst_parser&quot;</span><span class="p">,</span>  <span class="c1"># in order to use markdown</span>
<span class="p">]</span>

<span class="n">myst_enable_extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;colon_fence&quot;</span><span class="p">,</span>  <span class="c1"># ::: can be used instead of ``` for better rendering</span>
<span class="p">]</span>

<span class="n">html_theme</span> <span class="o">=</span> <span class="s2">&quot;sphinx_rtd_theme&quot;</span>
</pre></div>
</div>
<p>This is <code class="docutils literal notranslate"><span class="pre">index.md</span></code> (feel free to change the example text):</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span><span class="gh"># Our code documentation</span>

Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis
nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu
fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in
culpa qui officia deserunt mollit anim id est laborum.

:::{toctree}
:maxdepth: 2
:caption: Some caption

about.md
:::
</pre></div>
</div>
<p>This is <code class="docutils literal notranslate"><span class="pre">about.md</span></code> (feel free to adjust):</p>
<div class="highlight-markdown notranslate"><div class="highlight"><pre><span></span><span class="gh"># About this code</span>

Work in progress ...
</pre></div>
</div>
</li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">sphinx-build</span></code> to build the HTML documentation:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sphinx-build<span class="w"> </span>doc<span class="w"> </span>_build

<span class="go">... lots of output ...</span>
<span class="go">The HTML pages are in _build.</span>
</pre></div>
</div>
</li>
<li><p>Try to open <code class="docutils literal notranslate"><span class="pre">_build/index.html</span></code> in your browser.</p></li>
<li><p>Experiment with adding more content, images, equations, code blocks, …</p>
<ul class="simple">
<li><p><a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/syntax/typography.html">typography</a></p></li>
<li><p><a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/syntax/images_and_figures.html">images</a></p></li>
<li><p><a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/syntax/math.html">math and equations</a></p></li>
<li><p><a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/syntax/code_and_apis.html">code blocks</a></p></li>
</ul>
</li>
</ol>
</div>
<p>There is a lot more you can do:</p>
<ul>
<li><p>This is useful if you want to check the integrity of all internal and external links:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>sphinx-build<span class="w"> </span>doc<span class="w"> </span>-W<span class="w"> </span>-b<span class="w"> </span>linkcheck<span class="w"> </span>_build
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://pypi.org/project/sphinx-autobuild/">sphinx-autobuild</a>
provides a local web server that will automatically refresh your view
every time you save a file - which makes writing with live-preview much easier.</p></li>
</ul>
</section>
<section id="how-to-auto-generate-api-documentation-in-python">
<h4>How to auto-generate API documentation in Python<a class="headerlink" href="#how-to-auto-generate-api-documentation-in-python" title="Link to this heading"></a></h4>
<p>Add three tiny modifications (highlighted) to <code class="docutils literal notranslate"><span class="pre">doc/conf.py</span></code> to auto-generate API documentation
(this requires the <code class="docutils literal notranslate"><span class="pre">sphinx-autoapi</span></code> package):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">project</span> <span class="o">=</span> <span class="s2">&quot;your-project&quot;</span>
<span class="n">copyright</span> <span class="o">=</span> <span class="s2">&quot;2025, Authors&quot;</span>
<span class="n">author</span> <span class="o">=</span> <span class="s2">&quot;Authors&quot;</span>
<span class="n">release</span> <span class="o">=</span> <span class="s2">&quot;0.1&quot;</span>

<span class="n">exclude_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;_build&quot;</span><span class="p">,</span> <span class="s2">&quot;Thumbs.db&quot;</span><span class="p">,</span> <span class="s2">&quot;.DS_Store&quot;</span><span class="p">]</span>

<span class="n">extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;myst_parser&quot;</span><span class="p">,</span>  <span class="c1"># in order to use markdown</span>
<span class="hll">    <span class="s2">&quot;autoapi.extension&quot;</span><span class="p">,</span>  <span class="c1"># in order to use markdown</span>
</span><span class="p">]</span>

<span class="c1"># search this directory for Python files</span>
<span class="hll"><span class="n">autoapi_dirs</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;..&quot;</span><span class="p">]</span>
</span>
<span class="c1"># ignore this file when generating API documentation</span>
<span class="hll"><span class="n">autoapi_ignore</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;*/conf.py&quot;</span><span class="p">]</span>
</span>
<span class="n">myst_enable_extensions</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;colon_fence&quot;</span><span class="p">,</span>  <span class="c1"># ::: can be used instead of ``` for better rendering</span>
<span class="p">]</span>

<span class="n">html_theme</span> <span class="o">=</span> <span class="s2">&quot;sphinx_rtd_theme&quot;</span>
</pre></div>
</div>
<p>Then rebuild the documentation (or push the changes and let GitHub rebuild it)
and you should see a new section “API Reference”.</p>
</section>
<section id="possibilities-to-host-sphinx-documentation">
<h4>Possibilities to host Sphinx documentation<a class="headerlink" href="#possibilities-to-host-sphinx-documentation" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Build with <a class="reference external" href="https://github.com/features/actions">GitHub Actions</a> and deploy to <a class="reference external" href="https://pages.github.com/">GitHub Pages</a>.</p></li>
<li><p>Build with <a class="reference external" href="https://docs.gitlab.com/ee/ci/">GitLab CI/CD</a> and deploy to <a class="reference external" href="https://docs.gitlab.com/ee/user/project/pages/">GitLab Pages</a>.</p></li>
<li><p>Build with <a class="reference external" href="https://about.readthedocs.com/">Read the Docs</a> and host there.</p></li>
</ul>
</section>
<section id="confused-about-restructuredtext-vs-markdown-vs-myst">
<h4>Confused about reStructuredText vs. Markdown vs. MyST?<a class="headerlink" href="#confused-about-restructuredtext-vs-markdown-vs-myst" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>At the beginning there was reStructuredText and Sphinx was built for reStructuredText.</p></li>
<li><p>Independently, Markdown was invented and evolved into a couple of flavors.</p></li>
<li><p>Markdown became more and more popular but was limited compared to reStructuredText.</p></li>
<li><p>Later, <a class="reference external" href="https://myst-parser.readthedocs.io/en/latest/syntax/typography.html">MyST</a>
was invented to be able to write
something that looks like Markdown but in addition can do everything that
reStructuredText can do with extra directives.</p></li>
</ul>
</section>
<section id="where-to-read-more">
<h4>Where to read more<a class="headerlink" href="#where-to-read-more" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://coderefinery.github.io/documentation/">CodeRefinery documentation lesson</a></p></li>
<li><p><a class="reference external" href="https://www.sphinx-doc.org/">Sphinx documentation</a></p></li>
<li><p><a class="reference external" href="https://sphinx-rtd-tutorial.readthedocs.io/en/latest/index.html">Sphinx + ReadTheDocs guide</a></p></li>
<li><p>For more Markdown functionality, see the <a class="reference external" href="https://www.markdownguide.org/basic-syntax/">Markdown guide</a>.</p></li>
<li><p>For Sphinx additions, see <a class="reference external" href="https://www.sphinx-doc.org/en/master/markup/index.html">Sphinx Markup Constructs</a>.</p></li>
<li><p><a class="reference external" href="https://docs.python-guide.org/writing/documentation/">An opinionated guide on documentation in Python</a></p></li>
</ul>
</section>
</section>
<span id="document-profiling"></span><section id="profiling">
<h3>Profiling<a class="headerlink" href="#profiling" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Understand when improving code performance is worth the time and effort.</p></li>
<li><p>Knowing how to find performance bottlenecks in Python code.</p></li>
<li><p>Try <a class="reference external" href="https://github.com/plasma-umass/scalene">Scalene</a> as one of many tools
to profile Python code.</p></li>
</ul>
</div>
<p>[This page is adapted after <a class="reference external" href="https://aaltoscicomp.github.io/python-for-scicomp/profiling/">https://aaltoscicomp.github.io/python-for-scicomp/profiling/</a>]</p>
<section id="should-we-even-optimize-the-code">
<h4>Should we even optimize the code?<a class="headerlink" href="#should-we-even-optimize-the-code" title="Link to this heading"></a></h4>
<p>Classic quote to keep in mind: “Premature optimization is the root of all evil.” [Donald Knuth]</p>
<div class="admonition-discussion discussion important admonition" id="discussion-0">
<p class="admonition-title">Discussion</p>
<p>It is important to ask ourselves whether it is worth it.</p>
<ul class="simple">
<li><p>Is it worth spending e.g. 2 days to make a program run 20% faster?</p></li>
<li><p>Is it worth optimizing the code so that it spends 90% less memory?</p></li>
</ul>
<p>Depends. What does it depend on?</p>
</div>
</section>
<section id="measure-instead-of-guessing">
<h4>Measure instead of guessing<a class="headerlink" href="#measure-instead-of-guessing" title="Link to this heading"></a></h4>
<p>Before doing code surgery to optimize the run time or lower the memory usage,
we should <strong>measure</strong> where the bottlenecks are. This is called <strong>profiling</strong>.</p>
<p>Analogy: Medical doctors don’t start surgery based on guessing. They first measure
(X-ray, MRI, …) to know precisely where the problem is.</p>
<p>Not only programming beginners can otherwise guess wrong, but also experienced
programmers can be surprised by the results of profiling.</p>
</section>
<section id="one-of-the-simplest-tools-is-to-insert-timers">
<h4>One of the simplest tools is to insert timers<a class="headerlink" href="#one-of-the-simplest-tools-is-to-insert-timers" title="Link to this heading"></a></h4>
<p>Below we will list some tools that can be used to profile Python code.
But even without these tools you can find <strong>time-consuming parts</strong> of your code
by inserting timers:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span>

<span class="c1"># ...</span>
<span class="c1"># code before the function</span>


<span class="hll"><span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span class="n">result</span> <span class="o">=</span> <span class="n">some_function</span><span class="p">()</span>
<span class="hll"><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;some_function took </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">start</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
</span>

<span class="c1"># code after the function</span>
<span class="c1"># ...</span>
</pre></div>
</div>
</section>
<section id="many-tools-exist">
<h4>Many tools exist<a class="headerlink" href="#many-tools-exist" title="Link to this heading"></a></h4>
<p>The list below here is probably not complete, but it gives an overview of the
different tools available for profiling Python code.</p>
<p>CPU profilers:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/profile.html">cProfile and profile</a></p></li>
<li><p><a class="reference external" href="https://kernprof.readthedocs.io/">line_profiler</a></p></li>
<li><p><a class="reference external" href="https://github.com/benfred/py-spy">py-spy</a></p></li>
<li><p><a class="reference external" href="https://github.com/sumerc/yappi">Yappi</a></p></li>
<li><p><a class="reference external" href="https://pyinstrument.readthedocs.io/">pyinstrument</a></p></li>
<li><p><a class="reference external" href="https://perfetto.dev/docs/analysis/trace-processor-python">Perfetto</a></p></li>
</ul>
<p>Memory profilers:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pypi.org/project/memory-profiler/">memory_profiler</a> (not actively maintained)</p></li>
<li><p><a class="reference external" href="https://pympler.readthedocs.io/">Pympler</a></p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/tracemalloc.html">tracemalloc</a></p></li>
<li><p><a class="reference external" href="https://github.com/zhuyifei1999/guppy3/">guppy/heapy</a></p></li>
</ul>
<p>Both CPU and memory:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/plasma-umass/scalene">Scalene</a></p></li>
</ul>
<p>In the exercise below, we will use Scalene to profile a Python program. Scalene
is a sampling profiler that can profile CPU, memory, and GPU usage of Python.</p>
</section>
<section id="tracing-profilers-vs-sampling-profilers">
<h4>Tracing profilers vs. sampling profilers<a class="headerlink" href="#tracing-profilers-vs-sampling-profilers" title="Link to this heading"></a></h4>
<p><strong>Tracing profilers</strong> record every function call and event in the program,
logging the exact sequence and duration of events.</p>
<ul class="simple">
<li><p><strong>Pros:</strong></p>
<ul>
<li><p>Provides detailed information on the program’s execution.</p></li>
<li><p>Deterministic: Captures exact call sequences and timings.</p></li>
</ul>
</li>
<li><p><strong>Cons:</strong></p>
<ul>
<li><p>Higher overhead, slowing down the program.</p></li>
<li><p>Can generate larger amount of data.</p></li>
</ul>
</li>
</ul>
<p><strong>Sampling profilers</strong> periodically samples the program’s state (where it is
and how much memory is used), providing a statistical view of where time is
spent.</p>
<ul class="simple">
<li><p><strong>Pros:</strong></p>
<ul>
<li><p>Lower overhead, as it doesn’t track every event.</p></li>
<li><p>Scales better with larger programs.</p></li>
</ul>
</li>
<li><p><strong>Cons:</strong></p>
<ul>
<li><p>Less precise, potentially missing infrequent or short calls.</p></li>
<li><p>Provides an approximation rather than exact timing.</p></li>
</ul>
</li>
</ul>
<div class="admonition-analogy-imagine-we-want-to-optimize-the-london-underground-subway-system discussion important admonition" id="discussion-1">
<p class="admonition-title">Analogy: Imagine we want to optimize the London Underground (subway) system</p>
<p>We wish to detect bottlenecks in the system to improve the service and for this we have
asked few passengers to help us by tracking their journey.</p>
<ul class="simple">
<li><p><strong>Tracing</strong>: We follow every train and passenger, recording every stop
and delay. When passengers enter and exit the train, we record the exact time
and location.</p></li>
<li><p><strong>Sampling</strong>: Every 5 minutes the phone notifies the passenger to note
down their current location. We then use this information to estimate
the most crowded stations and trains.</p></li>
</ul>
</div>
</section>
<section id="choosing-the-right-system-size">
<h4>Choosing the right system size<a class="headerlink" href="#choosing-the-right-system-size" title="Link to this heading"></a></h4>
<p>Sometimes we can configure the system size (for instance the time step in a simulation
or the number of time steps or the matrix dimensions) to make the program finish sooner.</p>
<p>For profiling, we should choose a system size that is <strong>representative of the real-world</strong>
use case. If we profile a program with a small input size, we might not see the same
bottlenecks as when running the program with a larger input size.</p>
<p>Often, when we scale up the system size, or scale the number of processors, new bottlenecks
might appear which we didn’t see before. This brings us back to: “measure instead of guessing”.</p>
</section>
<section id="exercises">
<h4>Exercises<a class="headerlink" href="#exercises" title="Link to this heading"></a></h4>
<div class="admonition-exercise-practicing-profiling exercise important admonition" id="exercise-0">
<p class="admonition-title">Exercise: Practicing profiling</p>
<p>In this exercise we will use the Scalene profiler to find out where most of the time is spent
and most of the memory is used in a given code example.</p>
<p>Please try to go through the exercise in the following steps:</p>
<ol class="arabic">
<li><p>Make sure <code class="docutils literal notranslate"><span class="pre">scalene</span></code> is installed in your environment (if you have followed
this course from the start and installed the recommended software
environment, then it is).</p></li>
<li><p>Download Leo Tolstoy’s “War and Peace” from the following link (the text is
provided by <a class="reference external" href="https://www.gutenberg.org/">Project Gutenberg</a>):
<a class="reference external" href="https://www.gutenberg.org/cache/epub/2600/pg2600.txt">https://www.gutenberg.org/cache/epub/2600/pg2600.txt</a>
(right-click and “save as” to download the file and <strong>save it as “book.txt”</strong>).</p></li>
<li><p><strong>Before</strong> you run the profiler, try to predict in which function the code
(the example code is below)
will spend most of the time and in which function it will use most of the
memory.</p></li>
<li><p>Save the example code as <code class="docutils literal notranslate"><span class="pre">example.py</span></code> and
run the <code class="docutils literal notranslate"><span class="pre">scalene</span></code> profiler on the following code example and browse the
generated HTML report to find out where most of the time is spent and where
most of the memory is used:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>scalene<span class="w"> </span>example.py
</pre></div>
</div>
<p>Alternatively you can do this (and then open the generated file in a browser):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>scalene<span class="w"> </span>example.py<span class="w"> </span>--html<span class="w"> </span>&gt;<span class="w"> </span>profile.html
</pre></div>
</div>
<p>You can find an example of the generated HTML report in the solution below.</p>
</li>
<li><p>Does the result match your prediction? Can you explain the results?</p></li>
</ol>
<p>Example code (<code class="docutils literal notranslate"><span class="pre">example.py</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">The code below reads a text file and counts the number of unique words in it</span>
<span class="sd">(case-insensitive).</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">re</span>


<span class="k">def</span><span class="w"> </span><span class="nf">count_unique_words1</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\b\w+\b&quot;</span><span class="p">,</span> <span class="n">text</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">words</span><span class="p">))</span>


<span class="k">def</span><span class="w"> </span><span class="nf">count_unique_words2</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">unique_words</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\b\w+\b&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">word</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_words</span><span class="p">:</span>
                    <span class="n">unique_words</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_words</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">count_unique_words3</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="n">unique_words</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
            <span class="n">words</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;\b\w+\b&quot;</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
            <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">words</span><span class="p">:</span>
                <span class="n">unique_words</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">word</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">unique_words</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">():</span>
    <span class="c1"># book.txt is downloaded from https://www.gutenberg.org/cache/epub/2600/pg2600.txt</span>
    <span class="n">_result</span> <span class="o">=</span> <span class="n">count_unique_words1</span><span class="p">(</span><span class="s2">&quot;book.txt&quot;</span><span class="p">)</span>
    <span class="n">_result</span> <span class="o">=</span> <span class="n">count_unique_words2</span><span class="p">(</span><span class="s2">&quot;book.txt&quot;</span><span class="p">)</span>
    <span class="n">_result</span> <span class="o">=</span> <span class="n">count_unique_words3</span><span class="p">(</span><span class="s2">&quot;book.txt&quot;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition-solution solution important dropdown admonition" id="solution-0">
<p class="admonition-title">Solution</p>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="_images/exercise.png"><img alt="Result of the profiling run for the above code example." src="_images/exercise.png" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text">Result of the profiling run for the above code example. You can click on the image to make it larger.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Results:</p>
<ul class="simple">
<li><p>Most time is spent in the <code class="docutils literal notranslate"><span class="pre">count_unique_words2</span></code> function.</p></li>
<li><p>Most memory is used in the <code class="docutils literal notranslate"><span class="pre">count_unique_words1</span></code> function.</p></li>
</ul>
<p>Explanation:</p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">count_unique_words2</span></code> function is the slowest because it <strong>uses a list</strong>
to store unique words and checks if a word is already in the list before
adding it.
Checking whether a list contains an element might require traversing the
whole list, which is an O(n) operation. As the list grows in size,
the lookup time increases with the size of the list.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">count_unique_words1</span></code> and <code class="docutils literal notranslate"><span class="pre">count_unique_words3</span></code> functions are faster
because they <strong>use a set</strong> to store unique words.
Checking whether a set contains an element is an O(1) operation.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">count_unique_words1</span></code> function uses the most memory because it <strong>creates
a list of all words</strong> in the text file and then <strong>creates a set</strong> from that
list.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">count_unique_words3</span></code> function uses less memory because it traverses
the text file line by line instead of reading the whole file into memory.</p></li>
</ul>
<p>What we can learn from this exercise:</p>
<ul class="simple">
<li><p>When processing large files, it can be good to read them line by line
or in batches
instead of reading the whole file into memory.</p></li>
<li><p>It is good to get an overview over standard data structures and their
advantages and disadvantages (e.g. adding an element to a list is fast but checking whether
it already contains the element can be slow).</p></li>
</ul>
</div>
</div>
</section>
<section id="additional-resources">
<h4>Additional resources<a class="headerlink" href="#additional-resources" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://enccs.github.io/python-perf/profile/">Python performance workshop (by ENCCS)</a></p></li>
</ul>
</section>
</section>
<span id="document-testing"></span><section id="automated-testing">
<h3>Automated testing<a class="headerlink" href="#automated-testing" title="Link to this heading"></a></h3>
<div class="admonition-objectives objectives admonition" id="objectives-0">
<p class="admonition-title">Objectives</p>
<ul class="simple">
<li><p>Know <strong>where to start</strong> in your own project.</p></li>
<li><p>Know what possibilities and techniques are available in the Python world.</p></li>
</ul>
</div>
<section id="motivation">
<h4>Motivation<a class="headerlink" href="#motivation" title="Link to this heading"></a></h4>
<p>Testing is a way to check that the code does what it is expected to.</p>
<ul class="simple">
<li><p><strong>Less scary to change code</strong>: tests will tell you whether something broke.</p></li>
<li><p><strong>Easier for new people</strong> to join.</p></li>
<li><p>Easier for somebody to <strong>revive an old code</strong>.</p></li>
<li><p><strong>End-to-end test</strong>: run the whole code and compare result to a reference.</p></li>
<li><p><strong>Unit tests</strong>: test one unit (function or module). Can guide towards better
structured code: complicated code is more difficult to test.</p></li>
</ul>
</section>
<section id="how-testing-is-often-taught">
<h4>How testing is often taught<a class="headerlink" href="#how-testing-is-often-taught" title="Link to this heading"></a></h4>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">add</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>


<span class="k">def</span><span class="w"> </span><span class="nf">test_add</span><span class="p">():</span>
    <span class="k">assert</span> <span class="n">add</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span>
</pre></div>
</div>
<p>How this feels:</p>
<figure class="align-default" id="id1">
<a class="with-border reference internal image-reference" href="_images/owl.png"><img alt="Instruction on how to draw an owl" class="with-border" src="_images/owl.png" style="width: 50%;" />
</a>
<figcaption>
<p><span class="caption-text">[Citation needed]</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
</section>
<section id="where-to-start">
<h4>Where to start<a class="headerlink" href="#where-to-start" title="Link to this heading"></a></h4>
<p><strong>Do I even need testing?</strong>:</p>
<ul class="simple">
<li><p>A simple script or notebook probably does not need an automated test.</p></li>
</ul>
<p><strong>If you have nothing yet</strong>:</p>
<ul class="simple">
<li><p>Start with an end-to-end test.</p></li>
<li><p>Describe in words how <em>you</em> check whether the code still works.</p></li>
<li><p>Translate the words into a script (any language).</p></li>
<li><p>Run the script automatically on every code change (GitHub Actions or GitLab CI).</p></li>
</ul>
<p><strong>If you want to start with unit-testing</strong>:</p>
<ul class="simple">
<li><p>You want to rewrite a function? Start adding a unit test right there first.</p></li>
<li><p>You spend few days chasing a bug? Once you fix it, add a test to make sure it does not come back.</p></li>
</ul>
</section>
<section id="pytest">
<h4>Pytest<a class="headerlink" href="#pytest" title="Link to this heading"></a></h4>
<p>Here is a simple example of a test:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">fahrenheit_to_celsius</span><span class="p">(</span><span class="n">temp_f</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Converts temperature in Fahrenheit</span>
<span class="sd">    to Celsius.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">temp_c</span> <span class="o">=</span> <span class="p">(</span><span class="n">temp_f</span> <span class="o">-</span> <span class="mf">32.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">5.0</span><span class="o">/</span><span class="mf">9.0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">temp_c</span>


<span class="c1"># this is the test function</span>
<span class="hll"><span class="k">def</span><span class="w"> </span><span class="nf">test_fahrenheit_to_celsius</span><span class="p">():</span>
</span><span class="hll">    <span class="n">temp_c</span> <span class="o">=</span> <span class="n">fahrenheit_to_celsius</span><span class="p">(</span><span class="n">temp_f</span><span class="o">=</span><span class="mf">100.0</span><span class="p">)</span>
</span><span class="hll">    <span class="n">expected_result</span> <span class="o">=</span> <span class="mf">37.777777</span>
</span><span class="hll">    <span class="c1"># assert raises an error if the condition is not met</span>
</span><span class="hll">    <span class="k">assert</span> <span class="nb">abs</span><span class="p">(</span><span class="n">temp_c</span> <span class="o">-</span> <span class="n">expected_result</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0e-6</span>
</span></pre></div>
</div>
<p>To run the test(s):</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pytest<span class="w"> </span>example.py
</pre></div>
</div>
<p>Explanation: <code class="docutils literal notranslate"><span class="pre">pytest</span></code> will look for functions starting with <code class="docutils literal notranslate"><span class="pre">test_</span></code> in files
and directories given as arguments. It will run them and report the results.</p>
<p>Good practice to add unit tests:</p>
<ul class="simple">
<li><p>Add the test function and run it.</p></li>
<li><p>Break the function on purpose and run the test.</p></li>
<li><p>Does the test fail as expected?</p></li>
</ul>
</section>
<section id="what-else-is-possible">
<h4>What else is possible<a class="headerlink" href="#what-else-is-possible" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p>Run the test set <strong>automatically</strong> on every code change:</p>
<ul>
<li><p><a class="reference external" href="https://github.com/features/actions">GitHub Actions</a></p></li>
<li><p><a class="reference external" href="https://docs.gitlab.com/ee/ci/">GitLab CI</a></p></li>
</ul>
</li>
<li><p>The testing above used <strong>example-based</strong> testing.</p></li>
<li><p><strong>Test coverage</strong>: how much of the code is traversed by tests?</p>
<ul>
<li><p>Python: <a class="reference external" href="https://pytest-cov.readthedocs.io/">pytest-cov</a></p></li>
<li><p>Result can be deployed to services like <a class="reference external" href="https://about.codecov.io/">Codecov</a> or <a class="reference external" href="https://coveralls.io/">Coveralls</a>.</p></li>
</ul>
</li>
<li><p><strong>Property-based</strong> testing: generates arbitrary data matching your specification and checks that your guarantee still holds in that case.</p>
<ul>
<li><p>Python: <a class="reference external" href="https://hypothesis.readthedocs.io/">hypothesis</a></p></li>
</ul>
</li>
<li><p><strong>Snapshot-based</strong> testing: makes it easier to generate snapshots for regression tests.</p>
<ul>
<li><p>Python: <a class="reference external" href="https://syrupy-project.github.io/syrupy/">syrupy</a></p></li>
</ul>
</li>
<li><p><strong>Mutation testing</strong>: tests pass -&gt; change a line of code (make a mutant) -&gt; test again and check whether all mutants get “killed”.</p>
<ul>
<li><p>Python: <a class="reference external" href="https://mutmut.readthedocs.io/">mutmut</a></p></li>
</ul>
</li>
</ul>
</section>
<section id="further-reading">
<h4>Further reading<a class="headerlink" href="#further-reading" title="Link to this heading"></a></h4>
<ul class="simple">
<li><p><a class="reference external" href="https://coderefinery.github.io/testing/">CodeRefinery lesson about automated testing</a></p></li>
</ul>
</section>
</section>
</div>
<div class="toctree-wrapper compound">
<span id="document-credit"></span><section id="credit">
<h3>Credit<a class="headerlink" href="#credit" title="Link to this heading"></a></h3>
<p>The following material (all CC-BY) was reused to create this workshop material:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://aaltoscicomp.github.io/python-for-scicomp/">https://aaltoscicomp.github.io/python-for-scicomp/</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/data-visualization-python/">https://coderefinery.github.io/data-visualization-python/</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/reproducible-python/">https://coderefinery.github.io/reproducible-python/</a></p></li>
<li><p><a class="reference external" href="https://coderefinery.github.io/jupyter/">https://coderefinery.github.io/jupyter/</a></p></li>
</ul>
</section>
</div>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright CodeRefinery project (licensed under CC-BY).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>